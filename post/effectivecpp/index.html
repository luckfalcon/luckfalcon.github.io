<!doctype html>
<html lang="en-us">
  <head>
    <title>My // My New Hugo Site</title>
    <link rel="shortcut icon" href="/favicon.ico" />
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.118.2">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="John Doe" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="/css/main.min.3c3c186cd62e563ad6e2f00a89dbee656ab912d1d46f856b5605dd0232521e2a.css" />

    
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="My"/>
<meta name="twitter:description" content="luckfalconï¿½Ä²ï¿½ï¿½ï¿½ C&#43;&#43;ï¿½ï¿½ï¿½ï¿½×¢ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ìº¯ï¿½ï¿½ &mdash; ï¿½ï¿½Ê¼ï¿½ï¿½ &mdash;&ndash;A(B)&mdash; Ö»ï¿½ï¿½ï¿½ï¿½ï¿½Ú¶ï¿½ï¿½ó´´½ï¿½Ê± ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Öµï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ &ndash; Í¬ï¿½ï¿½ï¿½Í¶ï¿½ï¿½ï¿½Öµï¿½ï¿½Öµï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ &ndash;A=B Öµï¿½ï¿½ï¿½İ£ï¿½pass-by-valueï¿½ï¿½&ndash; ï¿½ï¿½ï¿½Ã¹ï¿½ï¿½ìº¯ï¿½ï¿½ ï¿½ï¿½ï¿½Ã´ï¿½ï¿½ï¿½ (passed-by-reference) &ndash; ï¿½ï¿½ï¿½ï¿½ï¿½Ã¹ï¿½ï¿½ìº¯ï¿½ï¿½ C&#43;&#43;ï¿½Ä´ï¿½ï¿½Î¼ï¿½ï¿½ï¿½ï¿½ï¿½
c ï¿½ï¿½ï¿½Ô²ï¿½ï¿½Ö±ï¿½ï¿½ï¿½ class ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ template Ä£ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ STL ï¿½ï¿½×¼ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ ï¿½ï¿½ï¿½ï¿½2ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ constï¿½ï¿½enumï¿½ï¿½inline ï¿½æ»» #define #define Ã»ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½î£¬ï¿½Ò²ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Í¼ï¿½ï¿½é£¬ï¿½ï¿½ï¿½ï¿½ï¿½Ç±ï¿½ï¿½ï¿½ï¿½æ»» (ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ç°ï¿½ï¿½×ºï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ê½ï¿½ï¿½ï¿½ï¿½)ï¿½ï¿½ #define max(a,b) f((a) &gt; (b)? (a) : (b)) int a = 5,b = 0; max(&#43;&#43;a, b);	//aï¿½ï¿½ï¿½Û¼ï¿½2ï¿½ï¿½ max(&#43;&#43;a, b&#43;10);	//aï¿½ï¿½ï¿½Û¼ï¿½1ï¿½ï¿½ enum hack (Ã¶ï¿½ï¿½hack) ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ê¼ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ğ¡ï¿½ï¿½ï¿½ï¿½Ä£ï¿½ï¿½Ôªï¿½ï¿½ï¿½ÌµÄ»ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ class Test {	static const int num = 1;//ï¿½Ë´ï¿½ï¿½ï¿½Îªï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ç¶ï¿½ï¿½ï¿½ int arr[num]; }; const int num;//ï¿½Ë´ï¿½Îªï¿½ï¿½ï¿½ï¿½,ï¿½ï¿½ï¿½ï¿½Êµï¿½ï¿½ï¿½Ä¼ï¿½ï¿½Ğ¶ï¿½ï¿½ï¿½Í·ï¿½Ä¼ï¿½ï¿½ï¿½ enum{num = 5}//ï¿½É´ï¿½ï¿½ï¿½ï¿½ï¿½ static const int class Test { private: enum {arr_size = 10};//ï¿½Ú±ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ö§ï¿½Ö±ï¿½ï¿½ï¿½ï¿½Ú¼ï¿½ï¿½ï¿½ï¿½ï¿½staticï¿½ï¿½ÖµÊ±(ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½) static const int arr[arr_size]; }; Ğ¡ï¿½ï¿½"/>

    <meta property="og:title" content="My" />
<meta property="og:description" content="luckfalconï¿½Ä²ï¿½ï¿½ï¿½ C&#43;&#43;ï¿½ï¿½ï¿½ï¿½×¢ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ìº¯ï¿½ï¿½ &mdash; ï¿½ï¿½Ê¼ï¿½ï¿½ &mdash;&ndash;A(B)&mdash; Ö»ï¿½ï¿½ï¿½ï¿½ï¿½Ú¶ï¿½ï¿½ó´´½ï¿½Ê± ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Öµï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ &ndash; Í¬ï¿½ï¿½ï¿½Í¶ï¿½ï¿½ï¿½Öµï¿½ï¿½Öµï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ &ndash;A=B Öµï¿½ï¿½ï¿½İ£ï¿½pass-by-valueï¿½ï¿½&ndash; ï¿½ï¿½ï¿½Ã¹ï¿½ï¿½ìº¯ï¿½ï¿½ ï¿½ï¿½ï¿½Ã´ï¿½ï¿½ï¿½ (passed-by-reference) &ndash; ï¿½ï¿½ï¿½ï¿½ï¿½Ã¹ï¿½ï¿½ìº¯ï¿½ï¿½ C&#43;&#43;ï¿½Ä´ï¿½ï¿½Î¼ï¿½ï¿½ï¿½ï¿½ï¿½
c ï¿½ï¿½ï¿½Ô²ï¿½ï¿½Ö±ï¿½ï¿½ï¿½ class ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ template Ä£ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ STL ï¿½ï¿½×¼ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ ï¿½ï¿½ï¿½ï¿½2ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ constï¿½ï¿½enumï¿½ï¿½inline ï¿½æ»» #define #define Ã»ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½î£¬ï¿½Ò²ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Í¼ï¿½ï¿½é£¬ï¿½ï¿½ï¿½ï¿½ï¿½Ç±ï¿½ï¿½ï¿½ï¿½æ»» (ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ç°ï¿½ï¿½×ºï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ê½ï¿½ï¿½ï¿½ï¿½)ï¿½ï¿½ #define max(a,b) f((a) &gt; (b)? (a) : (b)) int a = 5,b = 0; max(&#43;&#43;a, b);	//aï¿½ï¿½ï¿½Û¼ï¿½2ï¿½ï¿½ max(&#43;&#43;a, b&#43;10);	//aï¿½ï¿½ï¿½Û¼ï¿½1ï¿½ï¿½ enum hack (Ã¶ï¿½ï¿½hack) ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ê¼ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ğ¡ï¿½ï¿½ï¿½ï¿½Ä£ï¿½ï¿½Ôªï¿½ï¿½ï¿½ÌµÄ»ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ class Test {	static const int num = 1;//ï¿½Ë´ï¿½ï¿½ï¿½Îªï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ç¶ï¿½ï¿½ï¿½ int arr[num]; }; const int num;//ï¿½Ë´ï¿½Îªï¿½ï¿½ï¿½ï¿½,ï¿½ï¿½ï¿½ï¿½Êµï¿½ï¿½ï¿½Ä¼ï¿½ï¿½Ğ¶ï¿½ï¿½ï¿½Í·ï¿½Ä¼ï¿½ï¿½ï¿½ enum{num = 5}//ï¿½É´ï¿½ï¿½ï¿½ï¿½ï¿½ static const int class Test { private: enum {arr_size = 10};//ï¿½Ú±ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ö§ï¿½Ö±ï¿½ï¿½ï¿½ï¿½Ú¼ï¿½ï¿½ï¿½ï¿½ï¿½staticï¿½ï¿½ÖµÊ±(ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½) static const int arr[arr_size]; }; Ğ¡ï¿½ï¿½" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://luckfalcon.github.io/post/effectivecpp/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2023-10-23T01:41:54+08:00" />
<meta property="article:modified_time" content="2023-10-23T01:41:54+08:00" />


  </head>
  <body>
    <header class="app-header">
      <a href="https://luckfalcon.github.io/"><img class="app-header-avatar" src="/avatar.jpg" alt="John Doe" /></a>
      <span class="app-header-title">My New Hugo Site</span>
      <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nunc vehicula turpis sit amet elit pretium.</p>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">My</h1>
      <div class="post-meta">
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          Oct 23, 2023
        </div>
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          14 min read
        </div>
      </div>
    </header>
    <div class="post-content">
      <p><a href="http://luckfalcon.github.io">luckfalconµÄ²©¿Í</a>
<img src="" alt="test"></p>
<h1 id="c×¢">C++±à³Ì×¢ÒâÌõ¿î</h1>
<ul>
<li>¿½±´¹¹Ôìº¯Êı &mdash; ³õÊ¼»¯ &mdash;&ndash;A(B)&mdash; Ö»·¢ÉúÔÚ¶ÔÏó´´½¨Ê±</li>
<li>¿½±´¸³ÖµÔËËã·û &ndash; Í¬ÀàĞÍ¶ÔÏóÖµ¸³Öµ¸ø´´½¨¶ÔÏó &ndash;A=B</li>
<li>Öµ´«µİ£¨pass-by-value£©&ndash; µ÷ÓÃ¹¹Ôìº¯Êı</li>
<li>ÒıÓÃ´«µİ (passed-by-reference) &ndash; ²»µ÷ÓÃ¹¹Ôìº¯Êı</li>
</ul>
<p>C++ËÄ´ó´Î¼¶ÓïÑÔ</p>
<ul>
<li>c ÓïÑÔ²¿·Ö±à³Ì</li>
</ul>
<hr>
<ul>
<li>class Àà±à³Ì</li>
</ul>
<hr>
<ul>
<li>template Ä£°å±à³Ì</li>
</ul>
<hr>
<ul>
<li>STL ±ê×¼¿â±à³Ì</li>
</ul>
<hr>
<h2 id="2-constenuminline-æ»»-define">Ìõ¿î2£º¾¡Á¿ÒÔ const£¬enum£¬inline Ìæ»» #define</h2>
<ul>
<li>#define Ã»ÓĞ×÷ÓÃÓò¸ÅÄî£¬ÇÒ²»×öÀàĞÍ¼ì²é£¬½ö½öÊÇ±äÁ¿Ìæ»» (°üÀ¨±äÁ¿µÄÇ°ºó×º£¬±í´ïÊ½´úÈë)¡£</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">#define max(a,b) f((a) &gt; (b)? (a) : (b))
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> a <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>,b <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">max</span>(<span style="color:#f92672">++</span>a, b);	<span style="color:#75715e">//aï¿½ï¿½ï¿½Û¼ï¿½2ï¿½ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">max</span>(<span style="color:#f92672">++</span>a, b<span style="color:#f92672">+</span><span style="color:#ae81ff">10</span>);	<span style="color:#75715e">//aï¿½ï¿½ï¿½Û¼ï¿½1ï¿½ï¿½
</span></span></span></code></pre></div><ul>
<li>enum hack (Ã¶¾Ùhack) ³£ÓÃÀ´³õÊ¼»¯ÀàÄÚÊı×é´óĞ¡£¬ÊÇÄ£°åÔª±à³ÌµÄ»ù´¡¼¼Êõ¡£</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Test</span>
</span></span><span style="display:flex;"><span>{	
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">static</span> <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">int</span> num <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;<span style="color:#75715e">//ï¿½Ë´ï¿½ï¿½ï¿½Îªï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ç¶ï¿½ï¿½ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#66d9ef">int</span> arr[num];
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#66d9ef">int</span> num;<span style="color:#75715e">//ï¿½Ë´ï¿½Îªï¿½ï¿½ï¿½ï¿½,ï¿½ï¿½ï¿½ï¿½Êµï¿½ï¿½ï¿½Ä¼ï¿½ï¿½Ğ¶ï¿½ï¿½ï¿½Í·ï¿½Ä¼ï¿½ï¿½ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">enum</span>{num <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>}<span style="color:#75715e">//ï¿½É´ï¿½ï¿½ï¿½ï¿½ï¿½ static const int 
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Test</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">private</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">enum</span> {arr_size <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>};<span style="color:#75715e">//ï¿½Ú±ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ö§ï¿½Ö±ï¿½ï¿½ï¿½ï¿½Ú¼ï¿½ï¿½ï¿½ï¿½ï¿½staticï¿½ï¿½ÖµÊ±(ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#66d9ef">static</span> <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">int</span> arr[arr_size];
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>const ¶ÔÏóÌæ»» define ³£Á¿</li>
<li>inline º¯ÊıÌæ»» define ĞÎËÆº¯Êı</li>
</ul>
<h2 id="3Ê¹-const">Ìõ¿î3£º¾¡¿ÉÄÜÊ¹ÓÃ const</h2>
<ul>
<li>Áîº¯Êı·µ»ØÒ»¸ö³£Á¿Öµ£¬¿ÉÒÔ½µµÍ¿Í»§´íÎóºÍÒâÍâ·¢Éú£¬¶ø²»ÖÁÓÚ·ÅÆú°²È«ĞÔºÍ¸ßĞ§ĞÔ</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">//ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½operator*
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Rational</span>{}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> Rational <span style="color:#66d9ef">operator</span><span style="color:#f92672">*</span>(<span style="color:#66d9ef">const</span> Rational <span style="color:#f92672">&amp;</span>lhs,<span style="color:#66d9ef">const</span> Rational <span style="color:#f92672">&amp;</span>rhs);
</span></span><span style="display:flex;"><span><span style="color:#75715e">//ï¿½ï¿½ï¿½Ô±ï¿½ï¿½ï¿½ï¿½Í»ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Îªï¿½ï¿½:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>Rational a,b,c;
</span></span><span style="display:flex;"><span>(a <span style="color:#f92672">*</span> b) <span style="color:#f92672">=</span> c;<span style="color:#75715e">//ï¿½ï¿½a*bï¿½Ä½ï¿½ï¿½ï¿½ï¿½Ïµï¿½ï¿½Ã¸ï¿½Öµï¿½ï¿½ï¿½ï¿½ï¿½ï¿½operator =
</span></span></span></code></pre></div><ul>
<li>const ³ÉÔ±º¯Êı£¬¿ÉÈ·±£ÀàµÄ const ¶ÔÏó¿É±»²Ù×÷</li>
<li>Èç¹ıº¯ÊıµÄ·µ»ØÀàĞÍÊÇÄÚÖÃÀàĞÍ£¬¸Ä¶¯º¯Êı·µ»ØÖµÊÇ·Ç·¨µÄ</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">text</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">const</span> <span style="color:#f92672">&amp;</span><span style="color:#66d9ef">char</span> <span style="color:#66d9ef">operator</span>[](std<span style="color:#f92672">::</span>size_t position)<span style="color:#66d9ef">const</span><span style="color:#75715e">//ï¿½ï¿½ï¿½ï¿½constï¿½ï¿½ï¿½ó£¬²ï¿½ï¿½ï¿½ï¿½Ş¸Ä¶ï¿½ï¿½ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	{<span style="color:#66d9ef">return</span> st[position];}
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&amp;</span><span style="color:#66d9ef">char</span> <span style="color:#66d9ef">operator</span>[](std<span style="color:#f92672">::</span>size_t position)<span style="color:#75715e">//ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½constï¿½ï¿½ï¿½ï¿½,ï¿½ï¿½ï¿½Ş¸Ä¶ï¿½ï¿½ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	{<span style="color:#66d9ef">return</span> st[position];}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">private</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	std<span style="color:#f92672">::</span>string st;
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><ul>
<li>½«Àà³ÉÔ±ÉùÃ÷Îª mutable ÀàĞÍ£¬¿ÉÒÔÊµÏÖÔÚ const ¶ÔÏóÄÚĞŞ¸Ä¶ÔÏóµÄÖµ£¬µ«²¢ÄÜÍêÈ«½â¾ö const Óë non-const µÄÈ«²¿ÎÊÌâ¡£</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Text</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	std<span style="color:#f92672">::</span>size_t length()<span style="color:#66d9ef">const</span>;
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">private</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>ptex;
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">mutable</span> std<span style="color:#f92672">::</span>size_t textlength;<span style="color:#75715e">//ï¿½ï¿½Ğ©ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ô±ï¿½ï¿½Ş¸Ä£ï¿½ï¿½ï¿½Ê¹ï¿½ï¿½constï¿½ï¿½ï¿½ï¿½ï¿½Ú²ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#66d9ef">mutable</span> <span style="color:#66d9ef">bool</span> LengthIsValid;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>std<span style="color:#f92672">::</span>size_t Text<span style="color:#f92672">::</span> length()<span style="color:#66d9ef">const</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span>(<span style="color:#f92672">!</span>LengthIsValid)
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		textlength <span style="color:#f92672">=</span> strlen(ptex);
</span></span><span style="display:flex;"><span>		LengthIsValid <span style="color:#f92672">=</span> true;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> textlength;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>ÔÚ const ºÍ non-const ³ÉÔ±º¯ÊıÖĞ±ÜÃâÖØ¸´Ê¹ÓÃ£¬²ßÂÔÊÇÀûÓÃ non-const µ÷ÓÃ const µÄ°æ±¾À´ÊµÏÖ¡£</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">char</span> <span style="color:#66d9ef">operator</span>[](std<span style="color:#f92672">::</span>size_t position)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> 
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">const_cast</span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span> <span style="color:#f92672">&amp;&gt;</span>(		<span style="color:#75715e">//ï¿½ï¿½op[]ï¿½ï¿½ï¿½ï¿½ÖµÈ¥ï¿½ï¿½const
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		<span style="color:#66d9ef">static_cast</span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">const</span> text <span style="color:#f92672">&amp;&gt;</span>(<span style="color:#f92672">*</span><span style="color:#66d9ef">this</span>)<span style="color:#75715e">//Îªthisï¿½ï¿½ï¿½ï¿½constï¿½ï¿½ï¿½ï¿½ï¿½ï¿½const op[]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		)<span style="color:#75715e">//ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½thisï¿½ï¿½constï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Şµİ¹ï¿½ï¿½Ô¼ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>½«Ä³Ğ©¶«Î÷ÉùÃ÷Îª const ¿ÉÒÔ°ïÖú±àÒëÆ÷¼ì²é´íÎóÓÃ·¨¡£const ¿ÉÒÔ±»¼ÓÔÚÈÎºÎ×÷ÓÃÓòÄÚµÄ¶ÔÏó¡¢º¯Êı²ÎÊı¡¢º¯Êı·µ»ØÀàĞÍ¡¢³ÉÔ±º¯Êı¡£</li>
<li>±àÒëÆ÷Ç¿ÖÆ bitwise constness (Î»³£Á¿ĞÔ)£¬µ«Äã±à³ÌÊ±Ó¦Ê¹ÓÃ &ldquo;¸ÅÄîÉÏµÄ³£Á¿ĞÔ&rdquo; (conceptual constness)¡£</li>
<li>µ± const º¯ÊıÓë non-const º¯ÊıÓĞµÈ¼ÛµÄÊµÏÖÊ±£¬ÓÃ non-const °æ±¾µ÷ÓÃ const °æ±¾¿É±ÜÃâ´úÂëÖØ¸´¡£</li>
</ul>
<h2 id="4È·Ê¹Ç°È±Ê¼">Ìõ¿î4£ºÈ·¶¨¶ÔÏó±»Ê¹ÓÃÇ°ÒÑÏÈ±»³õÊ¼»¯</h2>
<ul>
<li>Î´³õÊ¼»¯¶ÔÏó¿Éµ¼ÖÂÎ´¶¨ÒåĞĞÎª (undefined behavior)£¬×îÖÕµ¼ÖÂ³ÌĞò´íÎó¡£</li>
<li>ÓÀÔ¶ÔÚ¶ÔÏóÊ¹ÓÃÖ®Ç°¶ÔÆä³õÊ¼»¯£¬ÄÚÖÃÀàĞÍÖ±½Ó³õÊ¼»¯£¬ÀàÀàĞÍÓÉÆä¹¹Ôìº¯ÊıÍê³É³õÊ¼»¯(Àà³ÉÔ±³õÊ¼»¯·¢ÉúÔÚ¹¹Ôìº¯ÊıÌåÖ®Ç°£¬¹¹Ôìº¯ÊıÌåÄÚÎª¸³Öµ£¬³õÊ¼»¯Àà³ÉÔ±Ó¦Ê¹ÓÃÀà³ÉÔ±³õÊ¼»¯ÁĞ±í)</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Obj</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	Obj(<span style="color:#66d9ef">int</span> i_nit,<span style="color:#66d9ef">char</span> c_init,<span style="color:#66d9ef">const</span> string <span style="color:#f92672">&amp;</span>s_init)
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">:</span>i(i_nit),c(c_init),s(s_init){}<span style="color:#75715e">//ï¿½ï¿½Ê¼ï¿½ï¿½ï¿½ï¿½Í¨ï¿½ï¿½Ğ§ï¿½Ê¸ï¿½ï¿½ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	Obj(<span style="color:#66d9ef">int</span> i_nit,<span style="color:#66d9ef">char</span> c_init,<span style="color:#66d9ef">const</span> string <span style="color:#f92672">&amp;</span>s_init)
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		i <span style="color:#f92672">=</span> i_nit;<span style="color:#75715e">//ï¿½ï¿½Öµï¿½ï¿½ï¿½ï¿½ï¿½Èµï¿½ï¿½ï¿½defaultï¿½ï¿½ï¿½ìº¯ï¿½ï¿½ï¿½ï¿½ï¿½Ù½ï¿½ï¿½Ğ¿ï¿½ï¿½ï¿½ï¿½ï¿½Öµ=
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		c <span style="color:#f92672">=</span> c_init;
</span></span><span style="display:flex;"><span>		s <span style="color:#f92672">=</span> s_init;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">private</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">int</span> i;
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">char</span> c;
</span></span><span style="display:flex;"><span>	string s;
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><ul>
<li>c++¶Ô&quot;¶¨ÒåÓÚ²»Í¬±àÒëµ¥ÔªÄÚµÄ non-local static ¶ÔÏó&quot;µÄ³õÊ¼»¯**´ÎĞò**²¢ÎŞÃ÷È·¶¨Òå¡£Í¨¹ıÉè¼ÆÏû³ıÕâÖÖÇé¿ö£¬×ö·¨ÊÇ£¬½«Ã¿¸ö non-local static ¶ÔÏó°áµ½×Ô¼ºµÄ×¨Êôº¯ÊıÄÚ(¸Ã¶ÔÏóÔÚ´Ëº¯ÊıÄÚ±»ÉùÃ÷Îª static)¡£ÕâĞ©º¯Êı·µ»ØÒ»¸ö reference Ö¸ÏòËüËùº¬µÄ¶ÔÏó¡£ÓÃ»§µ÷ÓÃÕâĞ©º¯Êı»ñµÃ static ¶ÔÏóµÄÒıÓÃ£¬¶ø·ÇÖ±½ÓÊ¹ÓÃ static ¶ÔÏó±¾Éí¡£</li>
</ul>
<blockquote>
<p>±àÒëµ¥Ôª (translation unit) ÊÇÖ¸²ú³öµ¥Ò»Ä¿±êÎÄ¼ş (sigle object file) µÄÔ´Âë¡£»ù±¾ÉÏËüÊÇµ¥Ò»Ô´ÂëÎÄ¼ş¼ÓÉÏÆäËùº¬ÈëµÄÍ·ÎÄ¼ş (#include file)¡£</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Ob1</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	Ob1 <span style="color:#f92672">&amp;</span>obj()<span style="color:#75715e">//ï¿½ï¿½ï¿½ï¿½ï¿½â¶¨ï¿½ï¿½Îªï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">static</span> Ob1 ob;
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> ob;<span style="color:#75715e">//Ö¸ï¿½ï¿½staticï¿½ï¿½ï¿½ï¿½ï¿½ï¿½referenceï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ê¹ï¿½ï¿½staticï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	}
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>ÄÚÖÃÀàĞÍÊÖ¶¯³õÊ¼»¯¡£</li>
<li>¹¹Ôìº¯ÊıÊ¹ÓÃ³ÉÔ±µÄ³õÊ¼»¯ÁĞ±í³õÊ¼»¯£¬¶ø·Ç¹¹Ôìº¯ÊıÌåÄÚ½øĞĞ¸³Öµ£¬³ÉÔ±³õÊ¼»¯´ÎĞò×îºÃÓëÉùÃ÷´ÎĞòÏàÍ¬¡£</li>
<li>ÎªÃâ³ı&quot;¿ç±àÒëµ¥Ôª³õÊ¼»¯´ÎĞò&quot;ÎÊÌâ£¬ÒÔ local static ¶ÔÏóÌæ»» non-local static ¶ÔÏó¡£</li>
</ul>
<h2 id="5cÄ­Ä­Ğ´Ñ">Ìõ¿î5£ºÁË½âc++Ä¬Ä¬Ğ´²¢µ÷ÓÃÄÄĞ©º¯Êı</h2>
<ul>
<li>¿ÕÀà£¬±àÒëÆ÷Ä¬ÈÏÉú³ÉÒ»¸öÎŞÊµ²ÎµÄ default ¹¹Ôìº¯Êı¡¢Ò»¸öÓĞÊµ²Î¿½±´¹¹Ôìº¯Êı¡¢Ò»¸ö¿½±´¸³ÖµÔËËã·û¡¢Ò»¸öÎö¹¹º¯Êı¡£</li>
<li>ÓÃ»§×Ô¶¨Òå¹¹Ôìº¯Êıºó£¬default ¹¹Ôìº¯Êı²»Ö¸¶¨Ôò±àÒëÆ÷²»ÔÙÌá¹©¡£</li>
<li>¶ÔÓÚ³ÉÔ±ÀàĞÍÎªÒıÓÃµÄÀà£¬±àÒëÆ÷Ä¬ÈÏ²»Éú³É¿½±´¸³ÖµÔËËã·û(Ô­ÒòÊÇ c++²»ÔÊĞí¸Ä±äÒıÓÃµÄ¶ÔÏó)¡£</li>
</ul>
<blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>±àÒëÆ÷¿ÉÒÔ°µ×ÔÎª class ´´½¨ default ¹¹Ôìº¯Êı¡¢copy ¹¹Ôìº¯Êı¡¢copy assighnment ²Ù×÷·û£¬ÒÔ¼°Îö¹¹º¯Êı¡£</li>
</ul>
<h2 id="6Ê¹Ã±Õ¦ÉµÄºÈ·">Ìõ¿î6£ºÈô²»ÏëÊ¹ÓÃ±àÒëÆ÷×Ô¶¯Éú³ÉµÄº¯Êı£¬¾Í¸ÃÃ÷È·¾Ü¾ø</h2>
<ul>
<li>ÎªÁË×èÖ¹ÀàµÄ¿½±´¸³ÖµĞĞÎª£¬Äã¿ÉÒÔÍ¨¹ı¼Ì³ĞÒ»¸ö»ùÀàµÄ¿½±´¸´ÖÆ²Ù×÷ÊÇ private µÄÀàÀ´ÊµÏÖ¡£</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Uncopy</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	Uncopy();
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">~</span>Uncopy();<span style="color:#75715e">//ï¿½ï¿½ï¿½Ú·ï¿½ï¿½éº¯ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ø¼Ì³Ğµï¿½ï¿½ï¿½ï¿½ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#66d9ef">private</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	Uncopy(<span style="color:#66d9ef">const</span> Uncopy<span style="color:#f92672">&amp;</span>);
</span></span><span style="display:flex;"><span>	Uncopy <span style="color:#f92672">&amp;</span><span style="color:#66d9ef">operator</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">const</span> Uncopy<span style="color:#f92672">&amp;</span>);
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Obj</span><span style="color:#f92672">:</span><span style="color:#66d9ef">private</span> Uncopy{};<span style="color:#75715e">//ï¿½ï¿½Ê±class Objï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½copyï¿½ï¿½ï¿½ï¿½ï¿½ï¿½copy assighnmentï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
</span></span></span></code></pre></div><blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>Îª²µ»Ø±àÒëÆ÷×Ô¶¯Ìá¹©µÄ¼¼ÄÜ£¬¿É½«ÏàÓ¦µÄ³ÉÔ±º¯ÊıÉùÃ÷Îª private ²¢ÇÒ²»ÓèÊµÏÖ£¬Èç uncopy »ùÀàµÄ×ö·¨¡£</li>
</ul>
<h2 id="7Ïvirtual">Ìõ¿î7£ºÎª¶àÌ¬»ùÀàÉùÃ÷virtualÎö¹¹º¯Êı</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Base</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	Base();
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">virtual</span> <span style="color:#a6e22e">function</span>();<span style="color:#75715e">//ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ô±ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Òªï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#66d9ef">virtual</span> <span style="color:#f92672">~</span>Base();<span style="color:#75715e">//ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Îªï¿½éº¯ï¿½ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DerivedA</span><span style="color:#f92672">:</span><span style="color:#66d9ef">public</span> Base{};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DerivedB</span><span style="color:#f92672">:</span><span style="color:#66d9ef">protected</span> Base{};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DerivedC</span> <span style="color:#f92672">:</span><span style="color:#66d9ef">private</span> Base{};
</span></span></code></pre></div><ul>
<li>Ã¿¸ö´øÓĞ virtual º¯ÊıµÄ class ¶¼ÓĞÒ»¸öÏàÓ¦µÄ vtbl(virtual table)£¬ÔÚÔËĞĞÊ±£¬ÓÉ vptr(virtual table pointer) Ö¸³ö£¬´Ó¶øÊµÏÖ´ø virtual º¯Êı¡£½«²»º¬ virtual º¯ÊıµÄÀàµÄÎö¹¹º¯ÊıÉùÃ÷Îª virtual »áÓ°ÏìÀàµÄ¿ÉÒÆÖ²ĞÔ¡£</li>
<li>»ùÀàµÄÎö¹¹º¯Êı·Ç virtual µÄÊ±£¬²»ÒªÊ¹ÓÃ»ùÀàÖ¸ÕëÖ¸ÏòÅÉÉúÀà£¬·ñÔòÔÚÏú»Ù»ùÀàÖ¸ÕëÊ±ÎŞ·¨µ÷ÓÃÅÉÉúÀàµÄÎö¹¹º¯Êı£¬´Ó¶øÔì³ÉÄÚ´æĞ¹Â©¡£</li>
<li>pure virtual Îö¹¹º¯ÊıµÄÀàÎª³éÏóÀà£¬ÎŞ·¨ÊµÀı»¯£¬Ö»ÊÊºÏ×ö»ùÀà¡£</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Obj</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">virtual</span> <span style="color:#f92672">~</span>Obj() <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;<span style="color:#75715e">//ï¿½ï¿½ï¿½éº¯ï¿½ï¿½,ï¿½ï¿½ï¿½ï¿½Îªï¿½ï¿½ï¿½ï¿½ï¿½à£¬ï¿½Ş·ï¿½Êµï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ö»ï¿½Êºï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>};
</span></span><span style="display:flex;"><span>Obj<span style="color:#f92672">::~</span>Obj(){};<span style="color:#75715e">//ï¿½ï¿½ï¿½éº¯ï¿½ï¿½ï¿½Ä¶ï¿½ï¿½ï¿½,ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½å£¬ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
</span></span></span></code></pre></div><ul>
<li>²¢·ÇËùÓĞµÄ»ùÀàÉè¼Æ¶¼ÊÇÎª¶àÌ¬ÓÃÍ¾£¬¼´²»ÊÇËùÓĞµÄ»ùÀà¶¼ĞèÒª virtual Îö¹¹º¯Êı¡£</li>
</ul>
<blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>polymorphic (´øÓĞ¶àÌ¬ĞÔÖÊµÄ) base classesÓ¦¸ÃÉùÃ÷Ò»¸ö virtual Îö¹¹º¯Êı¡£ÈçºÎ class ´øÓĞ virtual º¯Êı£¬ÄÇÃ´Ó¦¸ÃÉùÃ÷ virtual Îö¹¹º¯Êı¡£</li>
<li>classes µÄÉè¼ÆÄ¿µÄÈç¹û²»ÊÇ×÷Îª base classes Ê¹ÓÃ£¬»òÕß²»ÊÇÎªÁË¾ß±¸¶àÌ¬ĞÔ (polymorphically) £¬¾Í²»Ó¦¸ÃÉùÃ÷ virtual Îö¹¹º¯Êı¡£</li>
</ul>
<h2 id="8ì³£">Ìõ¿î8£º±ğÈÃÒì³£ÌÓÀëÎö¹¹º¯Êı</h2>
<ul>
<li>c++²»Ï£ÍûÔÚÀàµÄÎö¹¹º¯ÊıÖĞÅ×³öÒì³£(Õâ»áµ¼ÖÂÒ»Ğ©ÈİÆ÷ÓÉÓÚ¶à¸öÀà¶ÔÏóÎö¹¹Òì³£¶øµ¼ÖÂ²»Ã÷È·ĞĞÎª)</li>
<li>×ª½Ó¸ø¿Í»§Ò»´Î´¦ÀíÒì³£µÄ»ú»á</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Obj</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">static</span> obj create();<span style="color:#75715e">//ï¿½ï¿½ï¿½ï¿½Ò»ï¿½ï¿½objï¿½ï¿½ï¿½ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">closed</span>();<span style="color:#75715e">//ï¿½Ø±Õ£ï¿½Ê§ï¿½Ü»ï¿½ï¿½×³ï¿½ï¿½ì³£
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Manageobj</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">void</span> closed()
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		closed();<span style="color:#75715e">//ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½×³ï¿½ï¿½ì³£ï¿½É¹ï¿½ï¿½Ã»ï¿½Ñ¡ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½,ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ú£ï¿½ï¿½Ã»ï¿½ï¿½Ş·ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ö»ï¿½ï¿½Ñ¡ï¿½ï¿½ï¿½ï¿½Ö¹ï¿½ï¿½ï¿½ßºï¿½ï¿½ï¿½ï¿½ì³£
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		closed <span style="color:#f92672">=</span> true;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">~</span>Manageobj()
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">if</span>(<span style="color:#f92672">!</span>closed)
</span></span><span style="display:flex;"><span>		{
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">try</span>
</span></span><span style="display:flex;"><span>			{
</span></span><span style="display:flex;"><span>				closed();
</span></span><span style="display:flex;"><span>			}
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">catch</span>()
</span></span><span style="display:flex;"><span>			{
</span></span><span style="display:flex;"><span>			<span style="color:#75715e">//ï¿½ï¿½Â¼closeï¿½ï¿½ï¿½ï¿½Ê§ï¿½ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>			};
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">private</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	Obj oj;
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">bool</span> closed;
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>Îö¹¹º¯Êı¾ø¶Ô²»ÒªÅ×³öÒì³£¡£Èç¹ûÒ»¸ö±»Îö¹¹º¯Êıµ÷ÓÃµÄº¯Êı¿ÉÄÜÅ×³öÒì³££¬Îö¹¹º¯ÊıÓ¦¸Ã²¶×½ÈÎºÎÒì³££¬È»ºóÍÌÏÂËûÃÇ(×èÖ¹²»´«²¥)»ò½áÊø³ÌĞò¡£</li>
<li>Èç¹û¿Í»§ĞèÒª¶ÔÄ³¸ö²Ù×÷º¯ÊıÔËĞĞÆÚ¼äÅ×³öµÄÒì³£×ö³ö·´Ó¦£¬ÄÇÃ´ class Ó¦¸ÃÌá¹©Ò»¸öÆÕÍ¨µÄº¯Êı(¶ø·ÇÔÚÎö¹¹º¯ÊıÖĞ)Ö´ĞĞ¸Ã²Ù×÷¡£</li>
</ul>
<h2 id="9Ú¹Ğµvirtual">Ìõ¿î9£º¾ø²»ÔÚ¹¹ÔìºÍÎö¹¹¹ı³ÌÖĞµ÷ÓÃvirtualº¯Êı</h2>
<blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>ÔÚ¹¹ÔìºÍÎö¹¹ÆÚ¼ä²»Òªµ÷ÓÃ virtual º¯Êı£¬ÒòÎªÕâÀàµ÷ÓÃ´Ó²»ÏÂ½µÖÁ derived class (±ÈÆğµ±Ç°Ö´ĞĞ¹¹Ôìº¯ÊıºÍÎö¹¹º¯ÊıµÄÄÇ²ã)¡£</li>
</ul>
<h2 id="10operator--Ò»reference-to-this">Ìõ¿î10£ºÁîoperator = ·µ»ØÒ»¸öreference to *this</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Obj</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	Obj <span style="color:#f92672">&amp;</span><span style="color:#66d9ef">operator</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">const</span> Obj<span style="color:#f92672">&amp;</span>rhs)
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#75715e">//...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		<span style="color:#66d9ef">return</span> <span style="color:#f92672">*</span><span style="color:#66d9ef">this</span>;
</span></span><span style="display:flex;"><span>	}<span style="color:#75715e">//Îªï¿½ï¿½Êµï¿½ï¿½ x = y = z = Value;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>};
</span></span></code></pre></div><blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>Áî¸³Öµ(assignment)²Ù×÷·û·µ»ØÒ»¸öreference to *this¡£</li>
</ul>
<h2 id="11-operator--Ğ´Ò¹">Ìõ¿î11£ºÔÚ operator = ÖĞ´¦Àí¡°×ÔÎÒ¸³Öµ¡±</h2>
<ul>
<li>ÈÃ operator = ¾ß±¸&quot;Òì³£°²È«ĞÔ&quot;Í¬Ê±Ò²»á»ñµÃ&quot;×ÔÎÒ¸³Öµ°²È«&quot;¡£</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Op</span>{};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Obj</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">private</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	Op <span style="color:#f92672">*</span>ptr; <span style="color:#75715e">//ï¿½ï¿½ï¿½ï¿½Ô±ï¿½ï¿½ï¿½ï¿½Ö¸ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>};
</span></span><span style="display:flex;"><span>Obj <span style="color:#f92672">&amp;</span>Obj<span style="color:#f92672">::</span><span style="color:#66d9ef">operator</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">const</span> Obj <span style="color:#f92672">&amp;</span>rhs)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	Op <span style="color:#f92672">*</span>p <span style="color:#f92672">=</span> ptr;		<span style="color:#75715e">//ï¿½ï¿½×¡Ô­ï¿½Èµï¿½ptr
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	ptr <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Op(rhs.ptr);<span style="color:#75715e">//ï¿½ï¿½ptrÖ¸ï¿½ï¿½*ptrï¿½ï¿½Ò»ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#66d9ef">delete</span> p;			<span style="color:#75715e">//É¾ï¿½ï¿½Ô­ï¿½Èµï¿½ptr
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#66d9ef">return</span> <span style="color:#f92672">*</span><span style="color:#66d9ef">this</span>;
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>¸´ÖÆ½»»» (copy and swap) ¼¼Êõ£¬¿ÉÒÔ×÷ÎªÉÏÊö·½°¸µÄÌæ´ú·½°¸¡£</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Op</span>{};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Obj</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">void</span> swap(Obj <span style="color:#f92672">&amp;</span>rhs);
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">private</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	Op <span style="color:#f92672">*</span>ptr; <span style="color:#75715e">//ï¿½ï¿½ï¿½ï¿½Ô±ï¿½ï¿½ï¿½ï¿½Ö¸ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>};
</span></span><span style="display:flex;"><span>Obj <span style="color:#f92672">&amp;</span>Obj<span style="color:#f92672">::</span><span style="color:#66d9ef">operator</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">const</span> Obj <span style="color:#f92672">&amp;</span>rhs)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	Op <span style="color:#a6e22e">temp</span>(rhs);<span style="color:#75715e">//ï¿½ï¿½rhsï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ò»ï¿½İ¸ï¿½ï¿½ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	swap(temp);<span style="color:#75715e">//ï¿½ï¿½*thisï¿½ï¿½ï¿½İºï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½İ½ï¿½ï¿½ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#66d9ef">return</span> <span style="color:#f92672">*</span><span style="color:#66d9ef">this</span>;
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">//Öµï¿½ï¿½ï¿½ï¿½(passed by value)--ï¿½ï¿½Ê±ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½É¸ï¿½Ğ§ï¿½Ä´ï¿½ï¿½ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>Obj <span style="color:#f92672">&amp;</span>Obj<span style="color:#f92672">::</span><span style="color:#66d9ef">operator</span> <span style="color:#f92672">=</span> (Obj rhs)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	swap(ths);
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#f92672">*</span><span style="color:#66d9ef">this</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>È·±£µ±¶ÔÏó×ÔÎÒ¸³ÖµÊ± perator = ÓĞÁ¼ºÃµÄĞĞÎª¡£ÆäÖĞµÄ¼¼Êõ°üÀ¨±È½Ï&quot;À´Ô´¶ÔÏó&quot;ºÍ&quot;Ä¿±ê¶ÔÏó&quot;µÄµØÖ·¡¢¾«ĞÄÖÜµ½µÄÓï¾äË³Ñ°¡¢ÒÔ¼° copy-and-swap¡£</li>
<li>È·¶¨ÈÎºÎº¯ÊıÈçºÎ²Ù×÷Ò»¸öÒÔÉÏµÄ¶ÔÏó£¬¶øÆäÖĞ¶à¸ö¶ÔÏóÊÇÍ¬Ò»¸ö¶ÔÏóÊ±£¬ÆäĞĞÎªÈÔÈ»ÕıÈ·¡£</li>
</ul>
<h2 id="12Æ¶Ê±Ã¿Ò»É·">Ìõ¿î12£º¸´ÖÆ¶ÔÏóÊ±ÎğÍüÆäÃ¿Ò»¸ö³É·Ö</h2>
<ul>
<li>derived class µÄ base class ³É·ÖÔÚ derived class µÄ¹¹Ôìº¯ÊıÖĞÓ¦µ÷ÓÃ base class µÄ¹¹Ôìº¯ÊıÍê³É¡£</li>
<li>²»Ó¦¸ÃÁî copy assignment ²Ù×÷·ûµ÷ÓÃ copy ¹¹Ôìº¯Êı£¬·´Ö®Ò²Í¬ÑùÃ»ÓĞÒâÒå¡£</li>
<li>Èç¹û copy assignment ²Ù×÷·ûºÍ copy ¹¹Ôìº¯ÊıÓĞÏàÍ¬ÖØ¸´µÄ´úÂë£¬Í¨³£ÔÚ private ÇøÉèÖÃÒ»¸ö init º¯Êı½«ÏàÍ¬²¿·Ö´úÂë°üº¬½øÈ¥¡£</li>
</ul>
<blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li><em><strong>copy</strong></em>º¯Êı (copy assignment ²Ù×÷·ûºÍ copy ¹¹Ôìº¯ÊıÍ³³Æ) Ó¦¸ÃÈ·±£¸´ÖÆ&quot;¶ÔÏóÄÚµÄËùÓĞ³ÉÔ±±äÁ¿&quot;¼°&ldquo;ËùÓĞ base class ³É·Ö&rdquo;¡£</li>
<li>²»Òª³¢ÊÔÒÔÄ³¸ö copy º¯ÊıÊµÏÖÁíÒ»¸ö copy º¯Êı¡£Ó¦¸Ã½«¹²Í¬»úÄÜ·Å½øµÚÈı¸öº¯ÊıÖĞ£¬²¢ÓÉÁ½¸ö copy º¯Êı¹²Í¬µ÷ÓÃ¡£</li>
</ul>
<h2 id="13Õ¦Õ¤">Ìõ¿î13£ºÒÔ¶ÔÏó¹ÜÀí×ÊÔ´</h2>
<ul>
<li>»ñÈ¡×ÊÔ´ºóÁ¢¼´·Å½ø¹ÜÀí¶ÔÏóÄÚ£¬¹ÜÀí¶ÔÏóÔËÓÃÎö¹¹º¯ÊıÈ·±£×ÊÔ´±»ÊÍ·Å¡£ÒÔ¶ÔÏó¹ÜÀí×ÊÔ´³£±»³ÆÎª×ÊÔ´È¡µÃÊ±»ú±ãÊÇ³õÊ¼»¯Ê±»ú (Resource Acquisition Is Initialization,<em><strong>RAII</strong></em>)¡£</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Obj</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	Obj <span style="color:#f92672">*</span>create();
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">f</span>()
</span></span><span style="display:flex;"><span>{		<span style="color:#75715e">//c++11ï¿½ï¿½ï¿½Ñ¾ï¿½ï¿½ï¿½ï¿½ï¿½auto_ptr,ï¿½ï¿½unique_ptrï¿½ï¿½ï¿½ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#75715e">//ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ç°ï¿½ï¿½ï¿½Ç¾ï¿½ï¿½ï¿½Ã»ï¿½ï¿½Ò»ï¿½ï¿½ï¿½ï¿½ï¿½Ïµï¿½auto_ptrÍ¬Ê±Ö¸ï¿½ï¿½ï¿½Ã¶ï¿½ï¿½ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	std<span style="color:#f92672">::</span>auto_ptr<span style="color:#f92672">&lt;</span>Obj<span style="color:#f92672">&gt;</span>p_Obj(create());<span style="color:#75715e">//auto_ptrÎªÒ»ï¿½ï¿½ï¿½ï¿½Ö¸ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ä£ï¿½ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#75715e">//...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><ul>
<li>auto_ptrs Ò»¸öÌØÊâĞÔÖÊ£ºÈôÍ¨¹ı (copy assignment ²Ù×÷·ûºÍ copy ¹¹Ôìº¯Êı¸´ÖÆËüÃÇ£¬ËüÃÇ»á±ä³É null£¬¶ø¸´ÖÆËùµÃµÄÖ¸Õë½«È¡µÃ×ÊÔ´µÄÎ¨Ò»ÓµÓĞÈ¨¡£</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	std<span style="color:#f92672">::</span>auto_ptr1<span style="color:#f92672">&lt;</span>Obj<span style="color:#f92672">&gt;</span>p_Obj(create());<span style="color:#75715e">//ptr1Ö¸ï¿½ï¿½createï¿½ï¿½ï¿½Ø¶ï¿½ï¿½ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	std<span style="color:#f92672">::</span>auto_ptr2(ptr1);		<span style="color:#75715e">//ptr2Ö¸ï¿½ï¿½ï¿½Ã¶ï¿½ï¿½ï¿½ï¿½ï¿½ptr1ï¿½ï¿½ï¿½ï¿½Îªnull
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	ptr1 <span style="color:#f92672">=</span> ptr2;			<span style="color:#75715e">//ptr1Ö¸ï¿½ï¿½ï¿½Ã¶ï¿½ï¿½ï¿½ï¿½ï¿½ptr2ï¿½ï¿½ï¿½ï¿½Îªnull
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><ul>
<li>¿Ë·ş auto_ptr µÄ±×¶Ë£¬¸ÄÓÃÒıÓÃ¼ÆÊıÖÇÄÜÖ¸Õë (reference-counting smart pointer,RCSP)£¬Èç shared_ptr¡£</li>
<li>Ã»ÓĞÕë¶Ô &ldquo;c++¶¯Ì¬·ÖÅäÊı×é&rdquo; µÄÖÇÄÜÖ¸Õë£¬ÒòÎª vector ºÍ string ¼¸ºõ¿ÉÒÔÍêÈ«´úÌæ¶¯Ì¬·ÖÅäÊı×é¡£</li>
</ul>
<blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>Îª·ÀÖ¹×ÊÔ´Ğ¹Â¶£¬ÇëÊ¹ÓÃRAII¶ÔÏó£¬ËüÃÇÔÚ¹¹Ôìº¯ÊıÖĞ»ñÈ¡×ÊÔ´²¢ÔÚÎö¹¹º¯ÊıÖĞÊÍ·Å×ÊÔ´¡£</li>
<li>Á½¸ö³£ÓÃµÄ RAII classes ·Ö±ğÊÇ tr1::shared_ptr ºÍ auto_ptr(c++11ºóÓÃ unique_ptr)¡£Ç°ÕßÍ¨³£ÊÇ×î¼ÑÑ¡Ôñ£¬ÒòÎªÆä copy ĞĞÎª±È½ÏÖ±¹Û¡£ÈôÑ¡Ôñ auto_ptr£¬¸´ÖÆ¶¯×÷»áÊ¹Ëü (±»¸´ÖÆÎï) Ö¸Ïò null¡£</li>
</ul>
<h2 id="14Õ¤ÑcopingÏ">Ìõ¿î14£ºÔÚ×ÊÔ´¹ÜÀíÀàÖĞĞ¡ĞÄcopingĞĞÎª</h2>
<blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>¸´ÖÆRAII¶ÔÏó±ØĞëÒ»²¢¸´ÖÆËüËù¹ÜÀíµÄ×ÊÔ´£¬ËùÒÔ×ÊÔ´µÄcopyingĞĞÎª (Í¨³£ĞèÒªÉî¿½±´) ¾ö¶¨ RAII ¶ÔÏóµÄ copying ĞĞÎª¡£</li>
<li>ÆÕÍ¨¶ø³£¼ûµÄ RAII class copying ĞĞÎª£ºÒÖÖÆ copying¡¢(¿ÉÓÃ shared_ptr) Ê©ĞĞÒıÓÃ¼ÆÊı·½·¨ (reference counting)¡£²»¹ıÆäËûĞĞÎªÒ²¶¼¿ÉÄÜÊµÏÖ¡£</li>
</ul>
<h2 id="15Õ¤á¹©Ô­Ê¼Õ¤Ä·">Ìõ¿î15£ºÔÚ×ÊÔ´¹ÜÀíÀàÖĞÌá¹©¶ÔÔ­Ê¼×ÊÔ´µÄ·ÃÎÊ</h2>
<blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>APIs ÍùÍùÒªÇó·ÃÎÊÔ­Ê¼×ÊÔ´ (raw resources)£¬ËùÒÔÃ¿¸ö RAII class Ó¦¸ÃÌá¹©Ò»¸ö&quot;È¡µÃÆäËù¹ÜÀíÖ®×ÊÔ´&quot;µÄ°ì·¨¡£</li>
<li>¶ÔÔ­Ê¼×ÊÔ´µÄ·ÃÎÊ¿ÉÄÜ¾­ÓÉÏÔÊ¾×ª»»»òÒşÊ½×ª»»¡£Ò»°ã¶øÑÔÏÔÊ¾×ª»»±È½Ï°²È«£¬µ«ÒşÊ½×ª»»¶Ô¿Í»§±È½Ï·½±ã¡£</li>
</ul>
<h2 id="16É¶Ê¹newdeleteÊ±Ò«Ê½">Ìõ¿î16£º³É¶ÔÊ¹ÓÃnewºÍdeleteÊ±Òª²ÉÓÃÏàÍ¬ĞÎÊ½</h2>
<blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>new ±í´ïÊ½ÖĞÊ¹ÓÃ []£¬±ØĞëÔÚÏàÓ¦µÄ delete ±í´ïÊ½ÖĞÒ²Ê¹ÓÃ[]¡£new ±í´ïÊ½ÖĞ²»Ê¹ÓÃ []£¬Ò»¶¨²»ÒªÔÚÏàÓ¦µÄ delete ±í´ïÊ½ÖĞÊ¹ÓÃ []¡£</li>
</ul>
<h2 id="17Õ¦ä½«-newed-">Ìõ¿î17£ºÒÔ¶ÀÁ¢Óï¾ä½« newed ¶ÔÏóÖÃÈëÖÇÄÜÖ¸Õë</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Obj</span>{};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">func1</span>();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">func2</span>(shared_ptr<span style="color:#f92672">&lt;</span>obj<span style="color:#f92672">&gt;</span>,<span style="color:#66d9ef">int</span>);
</span></span><span style="display:flex;"><span>func2(shared_ptr<span style="color:#f92672">&lt;</span>obj<span style="color:#f92672">&gt;</span>(<span style="color:#66d9ef">new</span> obj),func1());
</span></span><span style="display:flex;"><span><span style="color:#75715e">//ï¿½Ë´ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Òªï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ì£ï¿½new Objï¿½ï¿½ï¿½ï¿½ï¿½ï¿½shared_ptrï¿½ï¿½Ê¼ï¿½ï¿½Ö¸ï¿½ë¡¢ï¿½ï¿½ï¿½ï¿½func1,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ã»ï¿½Ğ¹Ì¶ï¿½Ë³ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½func1ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ö®ï¿½ä£¬ï¿½Ò·ï¿½ï¿½ï¿½ï¿½ì³£ï¿½ï¿½ï¿½ï¿½ï¿½áµ¼ï¿½ï¿½new Objï¿½ï¿½ï¿½ï¿½Ğ¹Â©
</span></span></span></code></pre></div><blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>ÒÔ¶ÀÁ¢Óï¾ä½« newed ¶ÔÏó´æÈë(ÖÃÈë)ÖÇÄÜÖ¸ÕëÄÚ¡£Èç¹û²»ÕâÑù£¬Ò»µ©Òì³£±»Å×³ö£¬ÓĞ¿ÉÄÜµ¼ÖÂÄÑÒÔ²ì¾õµÄ×ÊÔ´Ğ¹Â©¡£</li>
</ul>
<h2 id="18Ã½Ó¿×±È·Ê¹Ã£×±">Ìõ¿î18£ºÈÃ½Ó¿ÚÈİÒ×±»ÕıÈ·Ê¹ÓÃ£¬²»Ò×±»ÎóÓÃ</h2>
<ul>
<li>¾¡Á¿ÈÃÄãµÄ types µÄĞĞÎªÓëÄÚÖÃ types Ò»ÖÂ¡£</li>
<li>·µ»Ø shared_ptr ÈÃ½Ó¿ÚÉè¼ÆÕßµÃÒÔ×èÖ¹´ó²¿·Ö×ÊÔ´Ğ¹Â©´íÎó¡£</li>
<li>ÖÇÄÜÖ¸Õë¹ÜÀí·Ç new µÄ×ÊÔ´Ê±ĞèÒªÊÖ¶¯´«ÈëÒ»¸öÉ¾³ıÆ÷¡£</li>
</ul>
<blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>ºÃµÄ½Ó¿ÚºÜÈİÒ×±»ÕıÈ·Ê¹ÓÃ£¬²»ÈİÒ×±»ÎóÓÃ¡£ÄãÓ¦¸ÃÔÚÄãµÄËùÓĞ½Ó¿ÚÖĞÅ¬Á¦´ïµ½Õâ¸öĞÔÖÊ¡£</li>
<li>&ldquo;´Ù½øÕùÈ¡Ê¹ÓÃ&rdquo;µÄ°ì·¨°üÀ¨½Ó¿ÚµÄÒ»ÖÂĞÔ£¬ÒÔ¼°ÓëÄÚÖÃÀàĞÍµÄĞĞÎª¼æÈİ¡£</li>
<li>&ldquo;×èÖ¹ÎóÓÃ&rdquo;µÄ°ì·¨ÊÇ½¨Á¢ĞÂÀàĞÍ¡¢ÏŞÖÆÀàĞÍÉÏµÄ²Ù×÷£¬Êø¸¿¶ÔÏóÖµ£¬ÒÔ¼°Ïû³ı¿Í»§µÄ×ÊÔ´¹ÜÀíÔğÈÎ¡£</li>
<li>shared_ptr Ö§³Ö¶¨ÖÆĞÍÉ¾³ıÆ÷ (custom deleter)¡£Õâ¿É·ÀÖ¹ DLL (¶¯Ì¬Á´½Ó¿â)ÎÊÌâ£¬¿É±»ÓÃÀ´×Ô¶¯½â³ı»¥³âËø (mutexes) µÈµÈ¡£</li>
</ul>
<blockquote>
<p>ËùÎ½µÄ &ldquo;cross-DLL problem&rdquo;£¬Õâ¸öÎÊÌâ·¢ÉúÓÚ&quot;¶ÔÏóÔÚ¶¯Ì¬Á¬½Ó³ÌĞò¿â (DLL) ÖĞ±» new ´´½¨£¬È´ÔÚÁíÒ»¸ö DLL ÄÚ±» delete
Ïú»Ù&quot;¡£</p>
</blockquote>
<h2 id="19-class--type">Ìõ¿î19£ºÉè¼Æ class ÓÌÈçÉè¼Æ type</h2>
<blockquote>
<p>ĞÂ class Éè¼Æ¹æ·¶ÎÊÌâ£º</p>
</blockquote>
<ul>
<li>ĞÂµÄ type Ó¦¸ÃÈçºÎ±»´´½¨ºÍÏú»Ù£¿</li>
<li>¶ÔÏóµÄ³õÊ¼»¯ºÍ¶ÔÏóµÄ¸³Öµ¸ÃÓĞÊ²Ã´ÑùµÄ²î±ğ£¿</li>
<li>ĞÂ type ¶ÔÏóÈç¹û±» passed by value (ÒÔÖµ´«µİ)£¬ÒâÎ¶×ÅÊ²Ã´£¿</li>
<li>Ê²Ã´ÊÇĞÂ type µÄ&quot;ºÏ·¨Öµ&quot;£¿</li>
<li>ÄãµÄĞÂ type ĞèÒªÅäºÏÄ³¸ö¼Ì³ĞÍ¼Ïµ (inheritance graph) Âğ£¿</li>
<li>ÄãµÄĞÂ type ĞèÒªÊ²Ã´ÑùµÄ×ª»»£¿</li>
<li>Ê²Ã´ÑùµÄ²Ù×÷·ûºÍº¯Êı¶Ô´ËĞÂ type ¶øÑÔÊÇºÏÀíµÄ£¿</li>
<li>Ê²Ã´ÑùµÄ±ê×¼º¯ÊıÓ¦¸Ã²µ»Ø£¿</li>
<li>Ë­¸ÃÈ¡ÓÃĞÂ type µÄ³ÉÔ±£¿</li>
<li>Ê²Ã´ÊÇĞÂ type µÄ&quot;Î´ÉùÃ÷½Ó¿Ú&quot;£¿</li>
<li>ÄãµÄĞÂ type ÓĞ¶àÃ´Ò»°ã»¯£¿</li>
<li>ÄãÕæµÄĞèÒªÒ»¸öĞÂ type Âğ£¿</li>
</ul>
<blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>class µÄÉè¼Æ¾ÍÊÇ type µÄÉè¼Æ¡£ÔÚ¶¨ÒåÒ»¸öĞÂtypeÊ±Çë¿¼ÂÇÒÔÉÏÎÊÌâ¡£</li>
</ul>
<h2 id="20-passed-by-reference-to-const-æ»»-passed-by-value">Ìõ¿î20£ºÄş¿ÉÒÔ passed-by-reference-to-const Ìæ»» passed-by-value</h2>
<ul>
<li>È±Ê¡Çé¿öÏÂ C++ ÒÔ by value ·½Ê½´«µİ¶ÔÏóÖÁº¯Êı¡£</li>
<li>Ò»°ã¶øÑÔ£¬pass by value Î¨Ò»¶ÔÏóÊÇÄÚÖÃÀàĞÍºÍ STL µÄµü´úÆ÷ºÍº¯Êı¶ÔÏó¡£</li>
</ul>
<blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>¾¡Á¿ÒÔ passed-by-reference-to-const Ìæ»» passed-by-value¡£Ç°ÕßÍ¨³£¸ßĞ§£¬²¢¿É±ÜÃâÇĞ¸îÎÊÌâ (slicing problem)¡£</li>
<li>ÒÔÉÏ¹æÔò²»ÊÊºÏÄÚÖÃÀàĞÍ£¬ÒÔ¼°STLµÄµü´úÆ÷ºÍº¯Êı¶ÔÏó¡£¶ÔËüÃÇ¶øÒÑ£¬passed-by-valueÍùÍù±È½ÏÊÊµ±¡£</li>
</ul>
<h2 id="21ë·µØ¶Ê±ë·µreference">Ìõ¿î21£º±ØĞë·µ»Ø¶ÔÏóÊ±£¬±ğÍıÏë·µ»ØÆäreference</h2>
<ul>
<li>Ò»¸ö&quot;±ØĞë·µ»ØĞÂ¶ÔÏó&quot;µÄÕıÈ·Ğ´·¨£º</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Rational</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	 Rational(<span style="color:#66d9ef">int</span> numerator <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>,<span style="color:#66d9ef">int</span> denominator <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">private</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">int</span> n;<span style="color:#75715e">//ï¿½ï¿½ï¿½ï¿½(numerator)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#66d9ef">int</span> d;<span style="color:#75715e">//ï¿½ï¿½Ä¸(denominator)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#66d9ef">friend</span> <span style="color:#66d9ef">const</span> Rational <span style="color:#66d9ef">operator</span><span style="color:#f92672">*</span>(<span style="color:#66d9ef">const</span> Rational <span style="color:#f92672">&amp;</span>lhs,<span style="color:#66d9ef">const</span> Rational <span style="color:#f92672">&amp;</span>rhs)
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">Rational</span>(lhs.n<span style="color:#f92672">*</span>rhs.n,lhs.d<span style="color:#f92672">*</span>rhs.d);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>¾ø²»Òª·µ»Ø pointer »ò reference Ö¸ÏòÒ»¸ö local stack ¶ÔÏó£¬»ò·µ»Ø reference Ö¸ÏòÒ»¸ö heap-allocated ¶ÔÏó£¬»ò·µ»Ø pointer »ò reference Ö¸ÏòÒ»¸ö local static ¶ÔÏó¶øÓĞ¿ÉÄÜÍ¬Ê±ĞèÒª¶à¸öÕâÑùµÄ¶ÔÏó¡£</li>
</ul>
<h2 id="22Õ¡Ï-private">Ìõ¿î22£º½«³ÉÔ±±äÁ¿ÉùÃ÷Îª private</h2>
<blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>ÇĞ¼Ç½«³ÉÔ±±äÁ¿ÉùÃ÷Îª private¡£Õâ¿É¸³Óè¿Í»§·ÃÎÊÊı¾İµÄÒ»ÖÂĞÔ¡¢¿ÉÏ¸Î¢»®·Ö·ÃÎÊ¿ØÖÆ¡¢ÔÊÅµÔ¼ÊøÌõ¼ş»ñµÃ±£Ö¤£¬²¢Ìá¹©class×÷ÕßÒÔ³ä·ÖµÄÊµÏÖµ¯ĞÔ¡£</li>
<li>protected ²¢²»±È public ¸ü¾ß·â×°ĞÔ¡£</li>
</ul>
<h2 id="23-non-membernon-friend-æ»»-member-">Ìõ¿î23£ºÄşÒÔ non-member¡¢non-friend Ìæ»» member º¯Êı</h2>
<ul>
<li>½«ËùÓĞ±ãÀûº¯Êı·ÅÔÚ¶à¸öÍ·ÎÄ¼şÄÚµ«Á¥ÊôÍ¬Ò»¸öÃüÃû¿Õ¼ä£¬ÒâÎ¶×Å¿Í»§¿ÉÒÔÀ©Õ¹ÕâÒ»×é±ãÀûº¯Êı¡£</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">// class_def.h
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">namespace</span> name
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Obj</span> 
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">void</span> fun1();
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">fun2</span>();
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">fun3</span>();
</span></span><span style="display:flex;"><span>	}<span style="color:#960050;background-color:#1e0010">ï¿½ï¿½</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">void</span> do_fun1(Obj <span style="color:#f92672">&amp;</span>oj){oj.fun1();}<span style="color:#75715e">//ï¿½ï¿½ï¿½Ä»ï¿½ï¿½Ü£ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Í»ï¿½ï¿½ï¿½ï¿½ï¿½Òªï¿½ï¿½non-memberï¿½ï¿½ï¿½ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">do_fun3</span>(Obj <span style="color:#f92672">&amp;</span>oj){oj.fun3();}<span style="color:#75715e">//ï¿½Ç³ï¿½Ô±ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ô½ï¿½Ò»ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½classï¿½Ä·ï¿½×°ï¿½ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">//fun1_use.h//ï¿½Í»ï¿½ï¿½ï¿½Õ¹Í·ï¿½Ä¼ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">namespace</span> name
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">fun1</span>();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>ÄşÒÔÄÃ non-member¡¢non-friend Ìæ»» member º¯Êı¡£ÕâÑù¿ÉÒÔÔö¼Ó·â×°ĞÔ¡¢°ü¹üµ¯ĞÔ (packaging flexibility) ºÍ»úÄÜÀ©³äĞÔ¡£</li>
</ul>
<h2 id="24Ğ²×ªÏ-non-member-">Ìõ¿î24£ºÈôËùÓĞ²ÎÊı½ÔĞèÀàĞÍ×ª»»£¬ÇëÎª´Ë²ÉÓÃ non-member º¯Êı</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Rational</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	 Rational(<span style="color:#66d9ef">int</span> numerator <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>,<span style="color:#66d9ef">int</span> denominator <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>	 <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">numerator</span>()<span style="color:#66d9ef">const</span>;
</span></span><span style="display:flex;"><span>	 <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">denominator</span>()<span style="color:#66d9ef">const</span>;
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">private</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">int</span> n;<span style="color:#75715e">//ï¿½ï¿½ï¿½ï¿½(numerator)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#66d9ef">int</span> d;<span style="color:#75715e">//ï¿½ï¿½Ä¸(denominator)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//ï¿½Ç³ï¿½Ô±ï¿½ï¿½Ôªï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ê½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> Rational <span style="color:#66d9ef">operator</span><span style="color:#f92672">*</span>(<span style="color:#66d9ef">const</span> Rational <span style="color:#f92672">&amp;</span>lhs,<span style="color:#66d9ef">const</span> Rational <span style="color:#f92672">&amp;</span>rhs)
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">Rational</span>(lhs.numerator()<span style="color:#f92672">*</span>rhs.numerator(),lhs.denominator()<span style="color:#f92672">*</span>rhs.denominator());
</span></span><span style="display:flex;"><span>	}
</span></span></code></pre></div><blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>Èç¹ûÄãĞèÒªÎªÄ³¸öº¯ÊıµÄËùÓĞ²ÎÊı (°üÀ¨±» this Ö¸ÕëËùÖ¸µÄÄÇ¸öÒşÓ÷²ÎÊı) ½øĞĞÀàĞÍ×ª»»£¬ÄÇÃ´Õâ¸öº¯Êı±ØĞëÊÇ non-member º¯Êı¡£</li>
</ul>
<h2 id="25Ğ´Ò»ì³£-swap-">Ìõ¿î25£º¿¼ÂÇĞ´³öÒ»¸ö²»Å×³öÒì³£µÄ swap º¯Êı</h2>
<ul>
<li>ËùÓĞµÄ STL ÈİÆ÷¶¼Ìá¹©ÓĞÒ»¸ö public swap ³ÉÔ±º¯ÊıºÍ std::swap ÌØ»¯°æ±¾ (ÓÃÒÔµ÷ÓÃÇ°Õß)¡£</li>
<li>c++ Ö»ÔÊĞí¶Ô class template Æ«ÌØ»¯ (partially specialize)£¬µ«²»ÄÜ¶Ô function template Æ«ÌØ»¯¡£</li>
<li>c++ std ¿Õ¼ä¿ÉÒÔÈ«ÌØ»¯ËùÓĞÄÚº¬ template£¬µ«²»¿ÉÒÔÌí¼ÓĞÂµÄ template ½øÈ¥¡£</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">namespace</span> name_obj
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Obj</span>
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">void</span> swap(<span style="color:#66d9ef">const</span> Obj <span style="color:#f92672">&amp;</span>b){<span style="color:#66d9ef">using</span> std<span style="color:#f92672">::</span>swap;};
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">swap</span>(Obj<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#f92672">&amp;</span>a,Obj<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#f92672">&amp;</span>b){a.swap(b);}<span style="color:#75715e">//ï¿½Ï·ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">namespace</span> std<span style="color:#75715e">//ï¿½ï¿½stdï¿½ï¿½ï¿½Ø»ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">template</span><span style="color:#f92672">&lt;&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> swap<span style="color:#f92672">&lt;</span>Obj<span style="color:#f92672">&gt;</span>(obj <span style="color:#f92672">&amp;</span>a,Obj <span style="color:#f92672">&amp;</span>b){a.swap(b);};<span style="color:#75715e">//ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ä³ï¿½ï¿½ï¿½à£¬ï¿½Ï·ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//Objï¿½ï¿½Îªï¿½ï¿½Ä£ï¿½ï¿½ï¿½ï¿½Ê±
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">template</span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">typename</span> T<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> swap<span style="color:#f92672">&lt;</span>Obj<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;&gt;</span>(Obj<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#f92672">&amp;</span>a,Obj<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#f92672">&amp;</span>b){a.swap(b);}<span style="color:#75715e">//ï¿½ï¿½ï¿½ï¿½Ä£ï¿½ï¿½Æ«ï¿½Ø»ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ó£¬²ï¿½ï¿½Ï·ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">template</span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">typename</span> T<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> swap(Obj<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#f92672">&amp;</span>a,Obj<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#f92672">&amp;</span>b){a.swap(b);}<span style="color:#75715e">//Ò²ï¿½ï¿½ï¿½Ï·ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><blockquote>
<p>pimpl ÊÇ &ldquo;pointer to implementation&rdquo; µÄËõĞ´¡£</p>
</blockquote>
<ul>
<li>swap µÄ°æ±¾°üº¬£¬default swap (ÊÊºÏ²»º¬Ö¸Õë³ÉÔ±µÄÀà»òÀàÄ£°å)¡¢member swap¡¢non-member swap¡¢std::swap ÌØ»¯°æ¡£</li>
<li>Èç¹ûÈ±Ê¡ swap Ğ§ÂÊ²»×ã (class »ò template Ê¹ÓÃÁËÄ³ÖÖ pimpl ÊÖ·¨)£¬¿ÉÊÔÒÔÏÂ·½·¨£º</li>
</ul>
<blockquote>
<ol>
<li>Ìá¹©Ò»¸ö public swap ³ÉÔ±º¯Êı£¬ÈÃËü¸ßĞ§µØÖÃ»»ÄãµÄÀàĞÍµÄÁ½¸ö¶ÔÏóÖµ¡£¸Ãº¯Êı²»Ó¦Å×³öÒì³£¡£</li>
<li>ÔÚÄãµÄ class »ò template ËùÔÚµÄÃüÃû¿Õ¼äÄÚÌá¹©Ò»¸ö non-member swap£¬²¢ÁîËüµ÷ÓÃÉÏÊö swap ³ÉÔ±º¯Êı¡£</li>
<li>Èç¹ûÄãÕı±àĞ´Ò»¸ö class (¶ø·Ç class template)£¬ÎªÄãµÄ class ÌØ»¯ std::swap¡£²¢ÁîËüµ÷ÓÃÄãµÄ swap ³ÉÔ±º¯Êı¡£</li>
</ol>
</blockquote>
<ul>
<li>swap Ò»¸ö×îºÃµÄÓ¦ÓÃÊÇ°ïÖú classes( ºÍ class templates) Ìá¹©Ç¿ÁÒµÄÒì³£ (exception-safety) ±£ÕÏ¡£</li>
</ul>
<blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>µ± std::swap ¶ÔÄãµÄÀàĞÍĞ§ÂÊ²»¸ßÊ±£¬Ìá¹©Ò»¸ö³ÉÔ± swap º¯Êı£¬²¢È·¶¨Õâ¸öº¯Êı²»Å×³öÒì³£¡£</li>
<li>Èç¹ûÄãÌá¹©Ò»¸ö member swap£¬Ò²¸ÃÌá¹©Ò»¸ö non-member swap ÓÃÀ´µ÷ÓÃÇ°Õß¡£¶ÔÓÚ class (¶ø·Ç template)£¬Ò²ÇëÌØ»¯ std::swap¡£</li>
<li>µ÷ÓÃ swap Ê±Ó¦Õë¶Ô std::swap Ê¹ÓÃ using ÉùÃ÷Ê½£¬È»ºóµ÷ÓÃ swap ²¢ÇÒ²»´øÈÎºÎ&quot;ÃüÃû¿Õ¼ä×Ê¸ñĞŞÊÎ&quot;¡£</li>
<li>Îª&quot;ÓÃ»§¶¨ÒåÀàĞÍ&quot;½øĞĞ std templates È«ÌØ»¯ÊÇºÃµÄ£¬µ«Ç§Íò²»Òª³¢ÊÔÔÚ std ÄÚ¼ÓÈëÄ³Ğ©¶Ô std ¶øÑÔÈ«ĞÂµÄ¶«Î÷¡£</li>
</ul>
<blockquote>
<p>Îå-ÊµÏÖ (implementations)</p>
</blockquote>
<h2 id="26Ó»Ê½Ä³Ê±">Ìõ¿î26£º¾¡¿ÉÄÜÑÓºó±äÁ¿¶¨ÒåÊ½µÄ³öÏÖÊ±¼ä</h2>
<ul>
<li>Ä¿µÄÊÇ¼õÉÙ²»±ØÒªµÄ¶ÔÏó¹¹ÔìºÍÎö¹¹</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Obj</span>{};
</span></span><span style="display:flex;"><span>Obj oj;	<span style="color:#75715e">//Aï¿½ï¿½1ï¿½Î¹ï¿½ï¿½ï¿½+1ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½+nï¿½Î¸ï¿½Öµ				
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i;i <span style="color:#f92672">&lt;</span> n;<span style="color:#f92672">++</span>i)	
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	oj <span style="color:#f92672">=</span> i;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i;i <span style="color:#f92672">&lt;</span> n;<span style="color:#f92672">++</span>i)	
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	Obj oj;	<span style="color:#75715e">//Bï¿½ï¿½nï¿½Î¹ï¿½ï¿½ï¿½+nï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Í¨ï¿½ï¿½Bï¿½ï¿½Aï¿½ï¿½ï¿½ï¿½Ğ§Ò»ï¿½ã£¬ï¿½ï¿½ï¿½Ç£ï¿½ï¿½ï¿½Öµï¿½È¹ï¿½ï¿½ï¿½+ï¿½ï¿½ï¿½ï¿½ï¿½É±ï¿½ï¿½ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	oj <span style="color:#f92672">=</span> i;
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>¾¡¿ÉÄÜÑÓºó±äÁ¿¶¨ÒåÊ½µÄ³öÏÖ¡£ÕâÑù×ö¿ÉÔö¼Ó³ÌĞòµÄÇåÎú¶È²¢¸ÄÉÆ³ÌĞòĞ§ÂÊ¡£</li>
</ul>
<h2 id="27×ªÍ·">Ìõ¿î27£º¾¡Á¿ÉÙ×ö×ªĞÍ¶¯×÷</h2>
<ul>
<li>c++ ÀàĞÍ×ª»»ĞÎÊ½ :</li>
</ul>
<p>const_cast<!-- raw HTML omitted -->(expression)|dynamic_cast<!-- raw HTML omitted -->(expression)|reinterpret_cast<!-- raw HTML omitted -->(expression)|static_cast<!-- raw HTML omitted -->(expression)
&mdash;-|
const µ½ non-const ×ª»»|ÔËĞĞÊ±£¬°²È«ÏòÏÂÀàĞÍ×ª»»|Ö´ĞĞµÍ¼¶×ªĞÍ|³ıÈ¥ const µ½ non-const µÄ×ª»»£¬ÆäËûÒ»°ãÀàĞÍ×ª»»</p>
<blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>Èç¹û¿ÉÒÔ£¬¾¡Á¿±ÜÃâ×ªĞÍ£¬ÌØ±ğÊÇÔÚ×¢ÖØĞ§ÂÊµÄ´úÂëÖĞ±ÜÃâ dynamic_cast¡£</li>
<li>Èç¹û×ªĞÍÊÇ±ØÒªµÄ£¬ÊÔ×Å½«ËüÒş²ØÓÚÄ³¸öº¯Êı±³ºó¡£¿Í»§Ëæºó¿ÉÒÔµ÷ÓÃ¸Ãº¯Êı£¬¶ø²»ĞèÒª½«×ªĞÍ·Åµ½ËûÃÇ×Ô¼ºµÄ´úÂëÄÚ¡£</li>
<li>Äş¿ÉÊ¹ÓÃ C++-style (ĞÂÊ½) ×ªĞÍ£¬²»ÒªÊ¹ÓÃ¾ÉÊ½×ªĞÍ¡£Ç°ÕßÈİÒ×±æÊ¶³öÀ´£¬¶øÇÒÒ²±È½ÏÓĞ×Å·ÖÃÅ±ğÀàµÄÖ´ÕÆ¡£</li>
</ul>
<h2 id="28-handles-Ú²É·">Ìõ¿î28£º±ÜÃâ·µ»Ø handles Ö¸Ïò¶ÔÏóÄÚ²¿³É·Ö</h2>
<blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>±ÜÃâ handles (°üÀ¨ references¡¢Ö¸Õë¡¢µü´úÆ÷)Ö¸Ïò¶ÔÏóÄÚ²¿¡£×ñÊØÕâ¸öÌõ¿î¿ÉÒÔÔö¼Ó·â×°ĞÔ£¬°ïÖú const ³ÉÔ±º¯ÊıµÄĞĞÎªÏñ¸ö const£¬²¢½«·¢Éú&quot;ĞéµõºÅÂëÅÆ&quot;(dangling handles) ¿ÉÄÜ½µµ½×îµÍ¡£</li>
</ul>
<blockquote>
<p>ĞéµõºÅÂëÅÆ£ºÊ¹ÓÃÒÑ¾­Ïú»ÙµÄ¶ÔÏóµÄÒıÓÃ¡¢Ö¸Õë»òµü´úÆ÷¡£</p>
</blockquote>
<h2 id="29Ïì³£È«Å­Ãµ">Ìõ¿î29£ºÎª&quot;Òì³£°²È«&quot;¶øÅ¬Á¦ÊÇÖµµÃµÄ</h2>
<ul>
<li>Òì³£°²È«ĞÔÁ½¸öÌõ¼ş£º</li>
</ul>
<blockquote>
<ol>
<li>Òì³£Å×³öÊ±£¬²»Ğ¹Â©ÈÎºÎ×ÊÔ´¡£</li>
<li>Òì³£Å×³öÊ±£¬²»ÔÊĞíÊı¾İ°Ü»µ¡£</li>
</ol>
</blockquote>
<ul>
<li>Òì³£°²È«º¯ÊıÌá¹©ÈıÖÖ²»Í¬¼¶±ğ±£Ö¤£º</li>
</ul>
<p>»ù±¾±£Ö¤|Ç¿ÁÒ±£Ö¤|²»Å×±£Ö¤
&mdash;-|
Òì³£Å×³öºó£¬³ÌĞòÄÚËùÓĞÊÂÎï±£³ÖÓĞĞ§×´Ì¬£¬ÕâĞ©×´Ì¬ÊÇÎ´Ô¤ÖªµÄ|Òì³£Å×³öºó£¬³ÌĞò×´Ì¬²»¸Ä±ä£¬»Øµ½±»µ÷ÓÃÇ°×´Ì¬|³ĞÅµ²»Å×³öÒì³££¬ÒòÆä×ÜÄÜÍê³ÉÔ­ÓĞµÄ¹¦ÄÜ¡£×÷ÓÃÓÚÄÚÖÃÀàĞÍËùÓĞ²Ù×÷Ó¦Ìá¹© nothrow ±£Ö¤</p>
<blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>Òì³£°²È«º¯Êı (Exception-safty functions) ¼´Ê¹·¢ÉúÒì³£Ò²²»»áĞ¹Â©×ÊÔ´»òÔÊĞíÈÎºÎÊı¾İ½á¹¹°Ü»µ¡£ÕâÑùµÄº¯ÊıÇø·ÖÎªÈıÖÖ¿ÉÄÜµÄ±£Ö¤£º»ù±¾ĞÍ¡¢Ç¿ÁÒĞÍ¡¢²»Å×Òì³£ĞÍ¡£</li>
<li>&ldquo;Ç¿ÁÒ±£Ö¤&rdquo; ÍùÍùÄÜ¹»ÒÔ copy-and-swap ÊµÏÖ³öÀ´£¬µ«&quot;Ç¿ÁÒ±£Ö¤&quot;²¢·Ç¶ÔËùÓĞº¯Êı¶¼¿ÉÊµÏÖ»ò¾ß±¸ÏÖÊµÒâÒå¡£</li>
<li>º¯ÊıÌá¹© &ldquo;Òì³£°²È«±£Ö¤&rdquo; Í¨³£×î¸ßÖ»µÈÓÚÆäËùµ÷ÓÃÖ®¸÷¸öº¯ÊıµÄ&quot;Òì³£°²È«±£Ö¤&quot;ÖĞµÄ×îÈõÕß¡£</li>
</ul>
<h2 id="30-inlining-">Ìõ¿î30£ºÍ¸³¹ÁË½â inlining µÄÀïÀïÍâÍâ</h2>
<ul>
<li>inlining ÔÚ´ó¶àÊı c++ ³ÌĞòÖĞÊÇ±àÒëÆÚĞĞÎª¡£</li>
<li>inline º¯ÊıÍ¨³£Ò»¶¨±»ÖÃÓÚÍ·ÎÄ¼şÖĞ£¬Í¨³£ÖÃÓÚº¯Êı±¾ÌåĞ¡µÄº¯ÊıÇ°£¬Ïò±àÒëÆ÷ÉêÇëÔÚµ÷ÓÃ´¦Ìæ»»Õ¹¿ª±¾Ìå£¬µ«·ÇÇ¿ÖÆÃüÁî£¬±àÒëÆ÷¿ÉºöÂÔ¡£</li>
<li>¶ÔÓÚº¯Êı±¾Ìå½Ï´óµÄº¯Êı inlining »áÒı·¢´úÂëÅòÕÍ¡£</li>
<li>±àÒëÆ÷Í¨³£²»»á¶Ô &ldquo;Í¨¹ıº¯ÊıÖ¸Õë¶ø½øĞĞµÄµ÷ÓÃ&rdquo; ÊµÊ© inlining¡£</li>
</ul>
<blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>½«´ó¶àÊı inlining ÏŞÖÆÔÚĞ¡ĞÍ¡¢±»Æµ·±µ÷ÓÃµÄº¯ÊıÉíÉÏ¡£Õâ¿ÉÊ¹ÈÕºóµÄµ÷ÊÔ¹ı³ÌºÍ¶ş½øÖÆÉı¼¶ (binary upgradability) ¸üÈİÒ×£¬Ò²¿ÉÊ¹Ç±ÔÚµÄ´úÂëÅòÕÍÎÊÌâ×îĞ¡»¯£¬Ê¹³ÌĞòµÄËÙ¶ÈÌáÉı»ú»á×î´ó»¯¡£</li>
<li>²»ÒªÖ»ÒòÎª function templates ³öÏÖÔÚÍ·ÎÄ¼ş£¬¾Í½«ËüÃÇÉùÃ÷Îª inline¡£</li>
</ul>
<h2 id="31Ä¼Ä±Ïµ">Ìõ¿î31£º½«ÎÄ¼ş¼äµÄ±àÒëÒÀ´æ¹ØÏµ½µÖÁ×îµÍ</h2>
<ul>
<li>½«½Ó¿ÚÓëÊµÏÖ·ÖÀë¡£</li>
<li>±àÒëÒÀ´æĞÔ×îĞ¡»¯µÄ±¾ÖÊ£ºÏÖÊµÖĞÈÃÍ·ÎÄ¼ş¾¡¿ÉÄÜ×ÔÎÒÂú×ã£¬ÍòÒ»×ö²»µ½£¬ÔòÈÃËüÓëÆä
ËûÎÄ¼şÄÚµÄÉùÃ÷Ê½¡´¶ø·Ç¶¨ÒåÊ½) ÏàÒÀ &ndash; ¸ÃÉè¼Æ²ßÂÔÈçÏÂ£º</li>
</ul>
<blockquote>
<ol>
<li>Èç¹ûÊ¹ÓÃ object references »ò object pointers ¿ÉÒÔÍê³ÉÈÎÎñ£¬¾Í²»ÒªÊ¹ÓÃ
objects¡£</li>
<li>Èç¹ûÄÜ¹»£¬¾¡Á¿ÒÔ class ÉùÃ÷Ê½Ìæ»» class ¶¨ÒåÊ½¡£</li>
<li>ÎªÉùÃ÷Ê½ºÍ¶¨ÒåÊ½Ìá¹©²»Í¬µÄÍ·ÎÄ¼ş¡£</li>
</ol>
</blockquote>
<ul>
<li>Handle classes ºÍ Interface classes ½â³ıÁË½Ó¿ÚºÍÊµÏÖÖ®¼äµÄñîºÏ¹ØÏµ£¬´Ó¶ø½µµÍÎÄ¼ş¼äµÄ±àÒëÒÀ´æĞÔ¡´compilation dependencies) ¡£</li>
</ul>
<blockquote>
<ol>
<li>ÔÚ Handle classes ÉíÉÏ£¬³ÉÔ±º¯Êı±ØĞëÍ¨¹ı implementation pointer È¡µÃ¶ÔÏóÊı¾İ¡£ÄÇ»áÎªÃ¿Ò»´Î·ÃÎÊÔö¼ÓÒ»²ã¼ä½ÓĞÔ¡£</li>
<li>ÖÁÓÚ Interface classes£¬ÓÉÓÚÃ¿¸öº¯Êı¶¼ÊÇ virtual£¬ËùÒÔÄã±ØĞëÎªÃ¿´Îº¯Êıµ÷ÓÃ¸¶³öÒ»¸ö¼ä½ÓÌøÔ¾ ¡´indirect jump) ³É±¾(¼ûÌõ¿î 7) ¡£</li>
</ol>
</blockquote>
<blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>Ö§³Ö &quot; ±àÒëÒÀ´æĞÔ×îĞ¡»¯ &quot; µÄÒ»°ã¹¹ÏëÊÇ: ÏàÒÀÓÚÉùÃ÷Ê½£¬²»ÒªÏàÒÀÓÚ¶¨ÒåÊ½¡£»ùÓÚ´Ë¹¹ÏëµÄÁ½¸öÊÖ¶ÎÊÇ Handle classes ºÍ Interface classes¡£</li>
<li>³ÌĞò¿âÍ·ÎÄ¼şÓ¦¸ÃÒÔ &quot; ÍêÈ«ÇÒ½öÓĞÉùÃ÷Ê½ &quot; (full and declaration-only forms) µÄĞÎÊ½´æÔÚ¡£ÕâÖÖ×ö·¨²»ÂÛÊÇ·ñÉæ¼°templates ¶¼ÊÊÓÃ¡£</li>
</ul>
<blockquote>
<p>Áù¡¢¼Ì³ĞÓëÃæÏò¶ÔÏó</p>
</blockquote>
<h2 id="32È·-public-Ä£-is-a-Ïµ">Ìõ¿î32£ºÈ·¶¨ÄãµÄ public ¼Ì³ĞËÜÄ£³ö is-a ¹ØÏµ</h2>
<ul>
<li>ÒÔ C++ ½øĞĞÃæÏò¶ÔÏó±à³Ì£¬×îÖØÒªµÄÒ»¸ö¹æÔòÊÇ£ºpublic inheritance (¹«¿ª¼Ì³Ğ) ÒâÎ¶ &ldquo;is-a&rdquo;¡´ÊÇÒ»ÖÖ) µÄ¹ØÏµ¡£</li>
<li>is-a ²¢·ÇÊÇÎ¨Ò»´æÔÚÓÚ classes Ö®¼äµÄ¹ØÏµ¡£ÁíÁ½¸ö³£¼ûµÄ¹ØÏµÊÇ has-a(ÓĞÒ»¸ö) ºÍ is-implemented-in-terms-of (¸ù¾İÄ³ÎïÊµÏÖ³ö)¡£</li>
</ul>
<blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>&ldquo;public ¼Ì³Ğ&quot;ÒâÎ¶ is-a¡£ÊÊÓÃÓÚ base classes ÉíÉÏµÄÃ¿Ò»¼şÊÂÇéÒ»¶¨Ò²ÊÊÓÃÓÚderived classes ÉíÉÏ£¬ÒòÎªÃ¿Ò»¸ö derived class ¶ÔÏóÒ²¶¼ÊÇÒ»¸ö base class ¶ÔÏó¡£</li>
</ul>
<h2 id="-33Ú¼Ğ¶">Ìõ¿î 33£º±ÜÃâÕÚÑÚ¼Ì³Ğ¶øÀ´µÄÃû³Æ</h2>
<ul>
<li>ÄÚ²ã×÷ÓÃÓòµÄÃû³Æ»áÕÚÑÚ (ÕÚ±Î) ÍâÎ§×÷ÓÃÓòµÄÃû³Æ¡£</li>
<li>±àÒëÆ÷²éÕÒÃû³Æ¹æÔòÓÉÄÚ²ã×÷ÓÃÓò²éÕÒµ½Ãû³Æºó¼´Í£Ö¹²éÕÒ£¬²¢²»¹Ø×¢ÀàĞÍ¡£</li>
<li>derived class ×÷ÓÃÓò±»Ç¶Ì×ÔÚ base class ×÷ÓÃÓòÄÚ¡£</li>
</ul>
<blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>derived classes ÄÚµÄÃû³Æ»áÕÚÑÚ base classes ÄÚµÄÃû³Æ¡£ ÔÚ public ¼Ì³ĞÏÂ´ÓÀ´Ã»ÓĞÈËÏ£ÍûÈç´Ë¡£</li>
<li>ÎªÁËÈÃ±»ÕÚÑÚµÄÃû³ÆÔÙ¼ûÌìÈÕ£¬¿ÉÊ¹ÓÃ using ÉùÃ÷Ê½»ò×ª½»º¯Êı ¡´forwarding functions) ¡£</li>
</ul>
<blockquote>
<p>using ÉùÃ÷Ê½ºÍ×ª½»º¯Êı£º</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">base</span>{ <span style="color:#66d9ef">public</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> fun1(<span style="color:#66d9ef">int</span> x);};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">derived1</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> base
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">using</span> base<span style="color:#f92672">::</span>fun1;
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">fun1</span>();
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">derived1</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">private</span> base
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> fun1()<span style="color:#75715e">//×ªï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>   {
</span></span><span style="display:flex;"><span>   	base<span style="color:#f92672">::</span>fun1();
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h2 id="-34Ó¿Ú¼ĞºÊµ">Ìõ¿î 34£ºÇø·Ö½Ó¿Ú¼Ì³ĞºÍÊµÏÖ¼Ì³Ğ</h2>
<ul>
<li>pure virtual º¯ÊıÓĞÁ½¸ö×îÍ»³öµÄÌØĞÔ£ºËüÃÇ±ØĞë±»ÈÎºÎ &quot; ¼Ì³ĞÁËËüÃÇ &quot; µÄ¾ßÏó class ÖØĞÂÉùÃ÷£¬¶øÇÒËüÃÇÔÚ³éÏó class ÖĞÍ¨³£Ã»ÓĞ¶¨Òå¡£</li>
</ul>
<blockquote>
<p>ÉùÃ÷Ò»¸ö pure virtual º¯ÊıµÄÄ¿µÄÊÇÎªÁËÈÃ derived classes Ö»¼Ì³Ğº¯Êı½Ó¿Ú¡£</p>
</blockquote>
<ul>
<li>derived classes ¼Ì³ĞÆäº¯Êı½Ó¿Ú, µ« impure virtual º¯Êı»áÌá¹©Ò»·İÊµÏÖ´úÂë, derived classes ¿ÉÄÜ¸²Ğ´ (override) Ëü¡£</li>
</ul>
<blockquote>
<p>ÉùÃ÷¼òÆÓµÄ(·Ç´¿) impure virtual º¯ÊıµÄÄ¿µÄ£¬ÊÇÈÃ derived classes ¼Ì³Ğ¸Ãº¯ÊıµÄ½Ó¿ÚºÍÈ±Ê¡ÊµÏÖ¡£</p>
</blockquote>
<ul>
<li>ÉùÃ÷ non-virtual º¯ÊıµÄÄ¿µÄÊÇÎªÁËÁî derived classes ¼Ì³Ğº¯ÊıµÄ½Ó¿Ú¼°Ò»·İÇ¿ÖÆĞÔÊµÏÖ¡£</li>
</ul>
<p>pure virtual º¯Êı|simple (impure) virtual º¯Êı|non-virtual º¯Êı
&mdash;-|
Ö»¼Ì³Ğ½Ó¿Ú|¼Ì³Ğ½Ó¿ÚºÍÒ»·İÈ±Ê¡ÊµÏÖ|¼Ì³Ğ½Ó¿ÚºÍÒ»·İÇ¿ÖÆÊµÏÖ</p>
<ul>
<li>&quot; 80 - 20 &quot; ·¨Ôò£ºÒ»¸öµäĞÍµÄ³ÌĞòÓĞ 80% µÄÖ´ĞĞÊ±¼ä»¨·ÑÔÚ 20% µÄ´úÂëÉíÉÏ¡£</li>
</ul>
<blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>½Ó¿Ú¼Ì³ĞºÍÊµÏÖ¼Ì³Ğ²»Í¬¡£ÔÚ public ¼Ì³ĞÖ®ÏÂ£¬derived classes ×ÜÊÇ¼Ì³Ğ base class µÄ½Ó¿Ú¡£</li>
<li>pure virtual º¯ÊıÖ»¾ßÌåÖ¸¶¨½Ó¿Ú¼Ì³Ğ¡£</li>
<li>¼òÆÓµÄ(·Ç´¿) impure virtual º¯Êı¾ßÌåÖ¸¶¨½Ó¿Ú¼Ì³Ğ¼°È±Ê¡ÊµÏÖ¼Ì³Ğ¡£</li>
<li>non-virtual º¯Êı¾ßÌåÖ¸¶¨½Ó¿Ú¼Ì³ĞÒÔ¼°Ç¿ÖÆĞÔÊµÏÖ¼Ì³Ğ¡£</li>
</ul>
<h2 id="-35-virtual-Ñ¡">Ìõ¿î 35£º¿¼ÂÇ virtual º¯ÊıÒÔÍâµÄÆäËûÑ¡Ôñ</h2>
<ul>
<li>Í¨¹ı Non-Virtual Interface ÊÖ·¨ÊµÏÖ Template Method Ä£Ê½£º</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Base</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">int</span> fun()<span style="color:#66d9ef">const</span><span style="color:#75715e">//ï¿½ï¿½ï¿½ï¿½no-virtual ï¿½ï¿½ï¿½ï¿½Îª virtual ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½â¸²ï¿½ï¿½ (wrapper)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">int</span> relval<span style="color:#f92672">=</span>dofun();
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> relval;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">private</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">int</span> dofun()<span style="color:#66d9ef">const</span>{...};
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><blockquote>
<p>Áî¿Í»§Í¨¹ı public non-virtual ³ÉÔ±º¯Êı¼ä½Óµ÷ÓÃ private virtual º¯Êı &ndash; Îª non-virtual interface (NVI) ÊÖ·¨¡£</p>
</blockquote>
<blockquote>
<p>derived classes ¿ÉÖØĞÂ¶¨Òå¼Ì³Ğ¶øÀ´µÄ private virtual º¯Êı¡£</p>
</blockquote>
<ul>
<li>Í¨¹ı Function Pointers ÊµÏÖ Strategy Ä£Ê½</li>
<li>Í¨¹ı º¯ÊıÄ£°å function &lt; T &gt; Íê³É Strategy Ä£Ê½</li>
</ul>
<blockquote>
<p>trl1: :bind£¬¿É¸Ä±ä¿Éµ÷¶ÔÏóÈë¿Ú²ÎÊı¸öÊıºÍË³Ğò£¬Í¬Ê±·µ»ØÒ»¸öĞÂµÄ¿Éµ÷¶ÔÏó¡£</p>
</blockquote>
<ul>
<li>¹ÅµäµÄ Strategy Ä£Ê½ (Éè¼ÆÄ£Ê½ (design patterns))¡£</li>
</ul>
<blockquote>
<p>¼¸ÖÖ virtual º¯ÊıÌæ´ú·½°¸ÈçÏÂ£º</p>
</blockquote>
<ol>
<li>Ê¹ÓÃ non-virtual interface (NVI) ÊÖ·¨£¬ÄÇÊÇ Template Method Éè¼ÆÄ£Ê½µÄÒ»ÖÖÌØÊâĞÎÊ½¡£ËüÒÔ public non-virtual ³ÉÔ±º¯Êı°ü×¯½ÏµÍ·ÃÎÊĞÔ(private »ò protected)µÄ virtual º¯Êı¡£</li>
<li>½« virtual º¯ÊıÌæ»»Îª &quot; º¯ÊıÖ¸Õë³ÉÔ±±äÁ¿ &ldquo;£¬ÕâÊÇ Strategy Éè¼ÆÄ£Ê½µÄÒ»ÖÖ·Ö½â±íÏÖĞÎÊ½¡£</li>
<li>ÒÔ trl::function ³ÉÔ±±äÁ¿Ìæ»» virtual º¯Êı£¬Òò¶øÔÊĞíÊ¹ÓÃÈÎºÎ¿Éµ÷ÓÃÎï(callable entity ) ´îÅäÒ»¸ö¼æÈİÓÚĞèÇóµÄÇ©ÃûÊ½¡£ÕâÒ²ÊÇ Strategy Éè¼ÆÄ£Ê½µÄÄ³ÖÖĞÎÊ½¡£</li>
<li>½«¼Ì³ĞÌåÏµÄÚµÄ virtual º¯ÊıÌæ»»ÎªÁíÒ»¸ö¼Ì³ĞÌåÏµÄÚµÄ virtual º¯Êı¡£ÕâÊÇ Strategy Éè¼ÆÄ£Ê½µÄ´«Í³ÊµÏÖÊÖ·¨¡£</li>
</ol>
<blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>virtual º¯ÊıµÄÌæ´ú·½°¸°üÀ¨ NVI ÊÖ·¨¼° Strategy Éè¼ÆÄ£Ê½µÄ¶àÖÖĞÎÊ½¡£NVIÊÖ·¨×ÔÉíÊÇÒ»¸öÌØÊâĞÎÊ½µÄ Template Method Éè¼ÆÄ£Ê½¡£</li>
<li>½«»úÄÜ´Ó³ÉÔ±º¯ÊıÒÆµ½ class Íâ²¿º¯Êı£¬´øÀ´µÄÒ»¸öÈ±µãÊÇ£¬·Ç³ÉÔ±º¯ÊıÎŞ·¨·ÃÎÊ class µÄ non-public ³ÉÔ±¡£</li>
<li>trl::function ¶ÔÏóµÄĞĞÎª¾ÍÏñÒ»°ãº¯ÊıÖ¸Õë¡£ÕâÑùµÄ¶ÔÏó¿É½ÓÄÉ &quot; Óë¸ø¶¨Ö®Ä¿±êÇ©ÃûÊ½ (target signature) ¼æÈİ &quot; µÄËùÓĞ¿Éµ÷ÓÃÎï(callable entities)¡£</li>
</ul>
<h2 id="-36Ğ¶-non-virtual-">Ìõ¿î 36£º¾ø²»ÖØĞÂ¶¨Òå¼Ì³Ğ¶øÀ´µÄ non-virtual º¯Êı</h2>
<ul>
<li>derived classes ¾ø¶Ô²»¸ÃÖØĞÂ¶¨ÒåÒ»¸ö¼Ì³Ğ¶øÀ´µÄnon-virtual º¯Êı¡´´Ë´¦Ö¸µÄÊÇ base class Îö¹¹º¯Êı) ¡£</li>
</ul>
<blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>¾ø¶Ô²»ÒªÖØĞÂ¶¨Òå¼Ì³Ğ¶øÀ´µÄ non-virtual º¯Êı¡£</li>
</ul>
<h2 id="-37-Ğ¶È±Ê¡Ä­">Ìõ¿î 37: ¾ø²»ÖØĞÂ¶¨Òå¼Ì³Ğ¶øÀ´µÄÈ±Ê¡(Ä¬ÈÏ)²ÎÊıÖµ</h2>
<ul>
<li>Ö»ÄÜ¼Ì³ĞÁ½ÖÖº¯Êı: virtual ºÍ non-virtual º¯Êı¡£</li>
<li>virtual º¯ÊıÏµ¶¯Ì¬°ó¶¨(dynamically bound) £¬¶øÈ±Ê¡(Ä¬ÈÏ)²ÎÊıÖµÈ´ÊÇ¾²Ì¬°ó¶¨¡´statically bound) ¡£</li>
</ul>
<blockquote>
<p>¶ÔÏóµÄËùÎ½¾²Ì¬ÀàĞÍ ¡´static type) £¬¾ÍÊÇËüÔÚ³ÌĞòÖĞ±»ÉùÃ÷Ê±Ëù²ÉÓÃµÄÀàĞÍ¡£</p>
</blockquote>
<blockquote>
<p>¶ÔÏóµÄËùÎ½¶¯Ì¬ÀàĞÍ(dynamic tvpe) ÔòÊÇÖ¸ &quot; Ä¿Ç°ËùÖ¸¶ÔÏóµÄÀàĞÍ &ldquo;¡£</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">base</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> set(base b <span style="color:#f92672">=</span> bs)<span style="color:#66d9ef">const</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;<span style="color:#75715e">//ï¿½ï¿½ï¿½ï¿½Ä¬ï¿½Ï²ï¿½ï¿½ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}<span style="color:#960050;background-color:#1e0010">ï¿½ï¿½</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">derived</span><span style="color:#f92672">:</span><span style="color:#66d9ef">public</span> base
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> set(base b <span style="color:#f92672">=</span> bs)<span style="color:#66d9ef">const</span>;<span style="color:#75715e">//ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ø¸ï¿½ï¿½ï¿½ï¿½ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">set</span>(base b <span style="color:#f92672">=</span> ds)<span style="color:#66d9ef">const</span>;<span style="color:#75715e">//Ä¬ï¿½Ï²ï¿½ï¿½ï¿½ï¿½ï¿½Ò»ï¿½ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">set</span>(base b)<span style="color:#66d9ef">const</span>;<span style="color:#75715e">//ï¿½ï¿½Ì¬ï¿½ï¿½ï¿½ï¿½(baseÖ¸ï¿½ï¿½ï¿½ï¿½ï¿½Ã·ï¿½ï¿½ï¿½Ê±)Ê±ï¿½Å»ï¿½ï¿½Ì³ï¿½baseÄ¬ï¿½Ï²ï¿½ï¿½ï¿½ï¿½ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#75715e">//ï¿½ï¿½Ì¬ï¿½ï¿½ï¿½ï¿½(derivedï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½)Ê±ï¿½ï¿½ï¿½ï¿½ï¿½Ì³ï¿½Ä¬ï¿½Ï²ï¿½ï¿½ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>};
</span></span></code></pre></div><ul>
<li>Ìõ¿î35ÁĞÁË²»ÉÙ virtual º¯ÊıµÄÌæ´úÉè¼Æ£¬ÆäÖĞÖ®Ò»ÊÇ NVI (non-virtual interface) ÊÖ·¨Áî base class ÄÚµÄÒ»¸ö public non-virtual º¯Êıµ÷ÓÃ private virtual º¯
Êı£¬ºóÕß¿É±» derived classes ÖØĞÂ¶¨Òå¡£</li>
</ul>
<blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>¾ø¶Ô²»ÒªÖØĞÂ¶¨ÒåÒ»¸ö¼Ì³Ğ¶øÀ´µÄÈ±Ê¡²ÎÊıÖµ£¬ÒòÎªÈ±Ê¡²ÎÊıÖµ¶¼ÊÇ¾²Ì¬°ó¶¨£¬¶ø virtual º¯ÊıÒ»Ò»ÄãÎ¨Ò»Ó¦¸Ã¸²Ğ´µÄ¶«Î÷Ò»Ò»È´ÊÇ¶¯Ì¬°ó¶¨¡£</li>
</ul>
<h2 id="-38-Ä£-has-a---Ä³Êµ-">Ìõ¿î 38: Í¨¹ı¸´ºÏËÜÄ£³ö has-a »ò ¡° ¸ù¾İÄ³ÎïÊµÏÖ³ö ¡±</h2>
<ul>
<li>¸´ºÏ(composition) ÊÇÀàĞÍÖ®¼äµÄÒ»ÖÖ¹ØÏµ£¬µ±Ä³ÖÖÀàĞÍµÄ¶ÔÏóÄÚº¬ËüÖÖÀàĞÍµÄ¶ÔÏó£¬±ãÊÇÕâÖÖ¹ØÏµ</li>
</ul>
<blockquote>
<p>¸´ºÏ(composition) Õâ¸öÊõÓïÓĞĞí¶àÍ¬Òå´Ê£¬°üÀ¨ layering (·Ö²ã) £¬constainment(ÄÚº¬) , aggregation (¾ÛºÏ) ºÍ embedding (ÄÚÇ¶)¡£</p>
</blockquote>
<ul>
<li>Ó¦ÓÃÓò(appjicarion domain)ÓëÊµÏÖÓò(implementation domain)</li>
</ul>
<blockquote>
<ol>
<li>³ÌĞòÖĞµÄ¶ÔÏóÆäÊµÏàµ±ÓÚÄãËùËÜÔìµÄÊÀ½çÖĞµÄÄ³Ğ©ÊÂÎï(ÈçÈË¡¢Æû³µ)£¬ÕâÑùµÄ¶ÔÏóÊôÓÚÓ¦ÓÃÓò (appjicarion domain) ²¿·Ö¡£</li>
<li>ÆäËû¶ÔÏóÔò´¿´âÊÇÊµÏÖÏ¸½ÚÉÏµÄÈË¹¤ÖÆÆ·(Èç»º³åÇø¡¢»¥³âËø)£¬ÕâĞ©¶ÔÏóÏàµ±ÓÚÄãµÄÈí¼şµÄÊµÏÖÓò¡£</li>
<li>µ±¸´ºÏ·¢ÉúÓÚÓ¦ÓÃÓòÄÚµÄ¶ÔÏóÖ®¼ä£¬±íÏÖ³ö has-a µÄ¹ØÏµ; µ±Ëü·¢ÉúÓÚÊµÏÖÓòÄÚÔòÊÇ±íÏÖ is-implemented-in-terms-of µÄ¹ØÏµ¡£</li>
</ol>
</blockquote>
<ul>
<li>set ºÍ list µÄ¹ØÏµ·Ç is-a ¹ØÏµ£¬¶øÊÇ is-implemented-in-terms-of ¹ØÏµ¡£</li>
</ul>
<blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>¸´ºÏ(composition) µÄÒâÒåºÍ public ¼Ì³ĞÍêÈ«²»Í¬¡£</li>
<li>ÔÚÓ¦ÓÃÓò (application domain) £¬¸´ºÏÒâÎ¶ has-a (ÓĞÒ»¸ö)¡£ÔÚÊµÏÖÓò(implementation domain) £¬¸´ºÏÒâÎ¶ is-implemented-in-terms-of (¸ù¾İÄ³ÎïÊµÏÖ³ö) ¡£</li>
</ul>
<h2 id="-39-ÆÊ¹-private-">Ìõ¿î 39: Ã÷ÖÇ¶øÉóÉ÷µØÊ¹ÓÃ Private ¼Ì³Ğ</h2>
<ul>
<li>Private ¼Ì³ĞÒâÎ¶ is-implemented-in-terms-of (¸ù¾İÄ³ÎïÊµÏÖ³ö)¡£</li>
<li>¾¡¿ÉÄÜÊ¹ÓÃ¸´ºÏ£¬±ØÒªÊ±²ÅÊ¹ÓÃ private ¼Ì³Ğ¡£</li>
<li>private ¼Ì³ĞÖ÷ÒªÓÃÓÚ &quot; µ±Ò»¸öÒâÓû³ÉÎª derived class ÕßÏë·ÃÎÊÒ»¸öÒâÓû³ÉÎª base class ÕßµÄ protected ³É·Ö£¬»òÎªÁËÖØĞÂ¶¨ÒåÒ»»ò¶à¸ö virtual º¯Êı &ldquo;¡£</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">empty</span>{};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">sizeof</span>(empty) <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">derived</span><span style="color:#f92672">:</span><span style="color:#66d9ef">private</span> empty
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">private</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">int</span> x;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">sizeof</span>(derived)<span style="color:#f92672">==</span><span style="color:#66d9ef">sizeof</span>(<span style="color:#66d9ef">int</span>);
</span></span><span style="display:flex;"><span><span style="color:#75715e">//ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ EBO (empty base optimization; ï¿½Õ°×»ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Å»ï¿½)ï¿½ï¿½Ò»ï¿½ã·¢ï¿½ï¿½ï¿½Úµï¿½Ò»ï¿½Ì³Ğ²Å¿ï¿½ï¿½Ğ£ï¿½ï¿½ï¿½ï¿½Ì³ï¿½ï¿½ò²»»á·¢ï¿½ï¿½ï¿½ï¿½
</span></span></span></code></pre></div><blockquote>
<ul>
<li>ÏÖÊµÖĞµÄ &quot; empty &quot; classes ²¢²»ÕæµÄÊÇ empty£¬ÍùÍùÄÚº¬ typedefs£¬enums£¬ static ³ÉÔ±±äÁ¿£¬»ò non-virtual º¯Êı¡£</li>
<li>Ğí¶à¼¼ÊõÓÃÍ¾µÄ empty classes£¬ÆäÖĞÄÚº¬ÓĞÓÃµÄ³ÉÔ± (Í¨³£ÊÇ typedefs)£¬°üÀ¨ base classes unary_function ºÍ binary_function£¬ÕâĞ©ÊÇ &quot; ÓÃ»§×Ô¶¨ÒåÖ®º¯Êı¶ÔÏó &quot; Í¨³£»á¼Ì³ĞµÄ classes¡£</li>
</ul>
</blockquote>
<blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>Private ¼Ì³ĞÒâÎ¶ is-implemented-in-terms of (¸ù¾İÄ³ÎïÊµÏÖ³ö) ¡£ËüÍ¨³£±È¸´ºÏ(composition) µÄ¼¶±ğµÍ¡£µ«ÊÇµ± derived class ĞèÒª·ÃÎÊ protected base class µÄ
³ÉÔ±£¬»òĞèÒªÖØĞÂ¶¨Òå¼Ì³Ğ¶øÀ´µÄ virtual º¯ÊıÊ±£¬ÕâÃ´Éè¼ÆÊÇºÏÀíµÄ¡£</li>
<li>ºÍ¸´ºÏ(composition) ²»Í¬£¬private ¼Ì³Ğ¿ÉÒÔÔì³É empty base ×îÓÅ»¯¡£Õâ¶ÔÖÂÁ¦ÓÚ &quot; ¶ÔÏó³ß´ç×îĞ¡»¯ &quot; µÄ³ÌĞò¿â¿ª·¢Õß¶øÑÔ£¬¿ÉÄÜºÜÖØÒª¡£</li>
</ul>
<h2 id="-40-ÆÊ¹Ã¶Ø¼">Ìõ¿î 40: Ã÷ÖÇ¶øÉóÉ÷µØÊ¹ÓÃ¶àÖØ¼Ì³Ğ</h2>
<ul>
<li>¶àÖØ¼Ì³Ğ(multiple inheritance£»MI)£¬µ¥Ò»¼Ì³Ğ (single inheritance; SI)¡£</li>
<li>C++ ÓÃÀ´½âÎö (resolving)ÖØÔØº¯Êıµ÷ÓÃµÄ¹æÔò£ºÔÚ¿´µ½ÊÇ·ñÓĞ¸öº¯Êı¿ÉÈ¡ÓÃÖ®Ç°£¬C++ Ê×ÏÈÈ·ÈÏÕâ¸öº¯Êı¶Ô´Ëµ÷ÓÃÖ®ÑÔÊÇ×î¼ÑÆ¥Åä¡£ÕÒ³ö×î¼ÑÆ¥Åäº¯Êıºó²Å¼ìÑéÆä¿ÉÈ¡ÓÃĞÔ¡£</li>
<li>¶àÖØ¼Ì³Ğ»áµ¼ÖÂ¶şÒåĞÔÎÊÌâ(±ÜÃâ¼Ì³ĞµÃÀ´µÄ³ÉÔ±±äÁ¿ÖØ¸´)£¬Í¨³£²ÉÓÃ virtual ¼Ì³Ğ:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">derived</span><span style="color:#f92672">:</span><span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">public</span> base1, <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">public</span> base2{};
</span></span></code></pre></div><blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>¶àÖØ¼Ì³Ğ±Èµ¥Ò»¼Ì³Ğ¸´ÔÓ¡£Ëü¿ÉÄÜµ¼ÖÂĞÂµÄÆçÒåĞÔ£¬ÒÔ¼°¶Ô virtual ¼Ì³ĞµÄĞèÒª¡£</li>
<li>virtual ¼Ì³Ğ»áÔö¼Ó´óĞ¡¡¢ËÙ¶È¡¢³õÊ¼»¯¡´¼°¸³Öµ) ¸´ÔÓ¶ÈµÈµÈ³É±¾¡£Èç¹û virtual base classes ²»´øÈÎºÎÊı¾İ£¬½«ÊÇ×î¾ßÊµÓÃ¼ÛÖµµÄÇé¿ö¡£</li>
<li>¶àÖØ¼Ì³ĞµÄÈ·ÓĞÕıµ±ÓÃÍ¾¡£ÆäÖĞÒ»¸öÇé½ÚÉæ¼° &quot; public ¼Ì³ĞÄ³¸ö Interface class &quot; ºÍ &quot; private ¼Ì³ĞÄ³¸öĞ­ÖúÊµÏÖµÄ class &quot; µÄÁ½Ïà×éºÏ¡£</li>
</ul>
<blockquote>
<p>Æß¡¢Ä£°åÓë·ºĞÍ±à³Ì</p>
</blockquote>
<h2 id="-41Ê½Ó¿ÚºÍ±Ú¶">Ìõ¿î 41£ºÁË½âÒşÊ½½Ó¿ÚºÍ±àÒëÆÚ¶àÌ¬</h2>
<ul>
<li>ÃæÏò¶ÔÏó±à³ÌÊÀ½ç×ÜÊÇÒÔÏÔÊ½½Ó¿Ú (explicit interfaces) ºÍÔËĞĞÆÚ¶àÌ¬ (runtime polymorphism) ½â¾öÎÊÌâ¡£</li>
<li>Templates ¼°·ºĞÍ±à³ÌµÄÊÀ½çÒÔÒşÊ½½Ó¿Ú (implicit interfaces) ºÍ±àÒëÆÚ¶àÌ¬ (compile-time polymorphism) ÎªÖ÷¡£</li>
</ul>
<blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>classes ºÍ templates ¶¼Ö§³Ö½Ó¿Ú (interfaces) ºÍ¶àÌ¬ (polymorphism) ¡£</li>
<li>¶Ô classes ¶øÑÔ½Ó¿ÚÊÇÏÔÊ½µÄ(explicit), ÒÔº¯ÊıÇ©ÃûÎªÖĞĞÄ¡£¶àÌ¬ÔòÊÇÍ¨¹ı virtual º¯Êı·¢ÉúÓÚÔËĞĞÆÚ¡£</li>
<li>¶Ô template ²ÎÊı¶øÑÔ£¬½Ó¿ÚÊÇÒşÊ½µÄ (implicit) £¬µì»ùÓÚÓĞĞ§±í´ïÊ½¡£¶àÌ¬ÔòÊÇÍ¨¹ı template ¾ßÏÖ»¯ºÍº¯ÊıÖØÔØ½âÎö (function overloading resolution ) ·¢ÉúÓÚ±àÒëÆÚ¡£</li>
</ul>
<h2 id="-42-typename-">Ìõ¿î 42£ºÁË½â typename µÄË«ÖØÒâÒå</h2>
<ul>
<li>C++ ÓĞ¸ö¹æÔò¿ÉÒÔ½âÎö (resoive) ´ËÒ»ÆçÒå×´Ì¬£ºÈç¹û½âÎöÆ÷ÔÚ template ÖĞÔâÓöÒ»¸öÇ¶Ì×´ÓÊôÃû³Æ£¬Ëü±ã¼ÙÉèÕâÃû³Æ²»ÊÇ¸öÀàĞÍ£¬³ı·ÇÄã¸æËßËüÊÇ¡£ËùÒÔÈ±Ê¡Çé¿öÏÂÇ¶Ì×´ÓÊôÃû³Æ²»ÊÇÀàĞÍ¡£</li>
</ul>
<blockquote>
<ul>
<li>template ÄÚ³öÏÖµÄÃû³ÆÈç¹ûÏàÒÀÓÚÄ³¸ö template ²ÎÊı£¬³ÆÖ®Îª´ÓÊôÃû³Æ (dependent names)¡£</li>
<li>Èç¹û´ÓÊôÃû³ÆÔÚ class ÄÚ³ÊÇ¶Ì××´£¬ÎÒÃÇ³ÆËüÎªÇ¶Ì×´ÓÊôÃû³Æ (nested dependent rame) ¡£</li>
</ul>
</blockquote>
<ul>
<li>Ö»ÒªÔÚÇ¶Ì×´ÓÊôÃû³ÆÖ®Ç°·ÅÖÃ¹Ø¼ü×Ö typename£¬¼´¿É¸æÖª½âÎöÆ÷¸ÃÃû³ÆÎªÀàĞÍ¡£</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">template</span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">typename</span> T<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">typename</span> T<span style="color:#f92672">::</span>const_iterator it();<span style="color:#75715e">//ï¿½ï¿½Öªï¿½ï¿½ï¿½ï¿½ï¿½ï¿½T::const_iterator Îªï¿½ï¿½ï¿½ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>T t;
</span></span><span style="display:flex;"><span><span style="color:#75715e">//T ï¿½ï¿½Ç¶ï¿½×´ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
</span></span></span></code></pre></div><ul>
<li>typename ²»¿ÉÒÔ³öÏÖÔÚ base classes list ÄÚµÄÇ¶Ì×´ÓÊôÀàĞÍÃû³ÆÖ®Ç°£¬Ò²²»¿ÉÔÚ mermber initialization list (³ÉÔ±³õÖµÁĞ) ÖĞ×÷Îª base class ĞŞÊÎ·û¡£</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">template</span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">typename</span> T<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">derived</span><span style="color:#f92672">:</span><span style="color:#66d9ef">public</span> base<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;::</span>nested <span style="color:#75715e">// base classes list
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">explicit</span> derived(<span style="color:#66d9ef">int</span> x)<span style="color:#f92672">:</span>base<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;::</span>nested(x)	<span style="color:#75715e">//ï¿½ï¿½Ô±ï¿½Ğ±ï¿½ï¿½ï¿½Ê¼ï¿½ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">typename</span>  base<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;::</span>nested temp;
</span></span><span style="display:flex;"><span>		<span style="color:#75715e">//...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	}
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>ÉùÃ÷ template ²ÎÊıÊ±£¬Ç°×º¹Ø¼ü×Ö class ºÍtypename ¿É»¥»»¡£</li>
<li>ÇëÊ¹ÓÃ¹Ø¼ü×Ö typename ±êÊ¶Ç¶Ì×´ÓÊôÀàĞÍÃû³Æ; µ«²»µÃÔÚ base class lists (»ùÀàÁĞ) »ò member initialization list (³ÉÔ±³õÖµÁĞ) ÄÚÒÔËü×÷Îª base class ĞŞÊÎ·û¡£</li>
</ul>
<h2 id="-43Ñ§Ï°Ä£å»¯Úµ">Ìõ¿î 43£ºÑ§Ï°´¦ÀíÄ£°å»¯»ùÀàÄÚµÄÃû³Æ</h2>
<ul>
<li>Ä£°å»¯»ùÀà (templatized base classes )ÄÚµÄº¯ÊıÃû³Æ»á±» derived classes ÑÚ¸Ç¡£</li>
<li>Èô»ùÀàÄ£°å´æÔÚÌØÀı»¯°æ±¾£¬ÔòÔÚ derived class template µÄÊ±ºò»á·¢Éú±àÒë´íÎó£¬ÕâÊ±¿ÉÒÔ½« derived class template Éæ¼° base class template µÄ³ÉÔ±º¯ÊıÇ°¼Ó &quot; this-&gt; &quot; À´Ö¸Éæ base class template ÄÚµÄº¯Êı¡£</li>
</ul>
<blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>¿ÉÔÚ derived class templates ÄÚÍ¨¹ı &ldquo;this-&gt;&rdquo; Ö¸Éæ base class templates ÄÚµÄ³ÉÔ±Ãû³Æ£¬»òÍ¨¹ıÒ»¸öÃ÷°×Ğ´³öµÄ &quot; base class ×Ê¸ñĞŞÊÎ·û &quot; Íê³É¡£</li>
</ul>
<h2 id="-44ØµÄµ-templates">Ìõ¿î 44£º½«Óë²ÎÊıÎŞ¹ØµÄ´úÂë³éÀë templates</h2>
<ul>
<li>¹²ĞÔÓë±äĞÔ·ÖÎö (commonality and variability analysis)</li>
</ul>
<blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>Templates Éú³É¶à¸ö classes ºÍ¶à¸öº¯Êı£¬ËùÒÔÈÎºÎ template ´úÂë¶¼²»¸ÃÓëÄ³¸öÔì³ÉÅòÕÍµÄ template ²ÎÊı²úÉúÏàÒÀ¹ØÏµ¡£</li>
<li>Òò·ÇÀàĞÍÄ£°å²ÎÊı (non-type template parameters) ¶øÔì³ÉµÄ´úÂëÅòÕÍ£¬ÍùÍù¿ÉÏû³ı£¬×ö·¨ÊÇÒÔº¯Êı²ÎÊı»ò class ³ÉÔ±±äÁ¿Ìæ»» template ²ÎÊı¡£</li>
<li>ÒòÀàĞÍ²ÎÊı (type parameters) ¶øÔì³ÉµÄ´úÂëÅòÕÍ£¬ÍùÍù¿É½µµÍ£¬×ö·¨ÊÇÈÃ´øÓĞÍêÈ«ÏàÍ¬¶ş½øÖÆ±íÊö (binary representations) µÄ¾ßÏÖÀàĞÍ (instantiation types) ¹²ÏíÊµÏÖÂë¡£</li>
</ul>
<h2 id="-45Ã³Õ¡Ä£Ğ¼">Ìõ¿î 45£ºÔËÓÃ³ÉÔ±º¯ÊıÄ£°å½ÓÊÜËùÓĞ¼æÈİÀàĞÍ</h2>
<ul>
<li>Èç¹ûÒÔ´øÓĞ base-derived ¹ØÏµµÄ B, D Á½ÀàĞÍ·Ö±ğ¾ßÏÖ»¯Ä³¸ö template£¬²úÉú³öÀ´µÄÁ½¸ö¾ßÏÖÌå²¢²»´øÓĞ base-derived ¹ØÏµ¡£</li>
<li>Templates ºÍ·ºĞÍ±à³Ì ( Generic Programming )</li>
<li>·º»¯(generalized) copy¹¹Ôìº¯Êı</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">template</span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">typename</span> T<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SmartPtr</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">//ï¿½ï¿½ï¿½ï¿½copyï¿½ï¿½ï¿½ìº¯ï¿½ï¿½,ï¿½ï¿½ï¿½ï¿½Ö¤Ö»ï¿½ï¿½ï¿½ï¿½Uï¿½ï¿½ï¿½ï¿½Tï¿½ï¿½ï¿½ï¿½,ï¿½ï¿½Ö¤publicï¿½Ì³Ğµï¿½ï¿½ï¿½Ê½×ªï¿½ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#75715e">//ï¿½ï¿½ï¿½ï¿½copyï¿½ï¿½ï¿½ìº¯ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½copyï¿½ï¿½ï¿½ìº¯ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Òªï¿½ï¿½ï¿½ï¿½copyï¿½ï¿½Îªï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ô¶ï¿½ï¿½ï¿½copyï¿½ï¿½ï¿½ìº¯ï¿½ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	SmartPtr(<span style="color:#66d9ef">const</span> SmartPtr <span style="color:#f92672">&amp;</span>sptr);<span style="color:#75715e">//ï¿½ï¿½Í¨copyï¿½ï¿½ï¿½ìº¯ï¿½ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#66d9ef">template</span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">typename</span> U<span style="color:#f92672">&gt;</span>		<span style="color:#75715e">//ï¿½ï¿½ï¿½ï¿½copyï¿½ï¿½ï¿½ìº¯ï¿½ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	SmartPtr(<span style="color:#66d9ef">const</span> SmartPtr<span style="color:#f92672">&lt;</span>U<span style="color:#f92672">&gt;</span> <span style="color:#f92672">&amp;</span>other)<span style="color:#f92672">:</span>heldPtr(other.get())
</span></span><span style="display:flex;"><span>	{...}
</span></span><span style="display:flex;"><span>	T <span style="color:#f92672">*</span><span style="color:#a6e22e">get</span>()<span style="color:#66d9ef">const</span> {<span style="color:#66d9ef">return</span> heldPtr;}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">private</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	T <span style="color:#f92672">*</span>heldPtr;
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>ÇëÊ¹ÓÃ member function templates (³ÉÔ±º¯ÊıÄ£°å) Éú³É &quot; ¿É½ÓÊÜËùÓĞ¼æÈİÀàĞÍ &quot; µÄº¯Êı¡£</li>
<li>Èç¹ûÄãÉùÃ÷ member templates ÓÃÓÚ &quot; ·º»¯ copy¹¹Ôìº¯Êı &quot; »ò &quot; ·º»¯ assigmment²Ù×÷ &ldquo;£¬Äã»¹ÊÇĞèÒªÉùÃ÷Õı³£µÄ copy ¹¹Ôìº¯ÊıºÍ copy assigmmenmt ²Ù×÷·û¡£</li>
</ul>
<h2 id="-46Ò«×ªÊ±ÏÄ£å¶¨Ç³Õ¡">Ìõ¿î 46£ºĞèÒªÀàĞÍ×ª»»Ê±ÇëÎªÄ£°å¶¨Òå·Ç³ÉÔ±º¯Êı</h2>
<ul>
<li>ÔÚ function template Êµ²ÎÍÆµ¼¹ı³ÌÖĞ´Ó²»½øĞĞÒşÊ½ÀàĞÍ×ª»»¡£</li>
<li>Class templates ²¢²»ÒĞÀµ tetmplate Êµ²ÎÍÆµ¼ ( ºóÕßÖ»Ê©ĞĞÓÚ function templates ÉíÉÏ) £¬ËùÒÔ±àÒëÆ÷×ÜÊÇÄÜ¹»ÔÚ class template ¾ßÏÖ»¯Ê±µÃÖª T¡£</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">template</span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">typename</span> T<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Rational</span><span style="color:#75715e">//template class
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	 Rational(T numerator <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>,T denominator <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>	 T <span style="color:#a6e22e">numerator</span>()<span style="color:#66d9ef">const</span>;
</span></span><span style="display:flex;"><span>	 T <span style="color:#a6e22e">denominator</span>()<span style="color:#66d9ef">const</span>;
</span></span><span style="display:flex;"><span>	 <span style="color:#66d9ef">friend</span> <span style="color:#66d9ef">const</span> Rational <span style="color:#66d9ef">operator</span><span style="color:#f92672">*</span>(<span style="color:#66d9ef">const</span> Rational <span style="color:#f92672">&amp;</span>lhs,<span style="color:#66d9ef">const</span> Rational <span style="color:#f92672">&amp;</span>rhs)
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">Rational</span>(lhs.numerator()<span style="color:#f92672">*</span>rhs.numerator(),lhs.denominator()<span style="color:#f92672">*</span>rhs.denominator());
</span></span><span style="display:flex;"><span>	}<span style="color:#75715e">//ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½â²¿Ê±ï¿½ï¿½ï¿½ï¿½Ö»ï¿½ï¿½Í¨ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½È´ï¿½Ş·ï¿½ï¿½ï¿½ï¿½ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#66d9ef">private</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	T n;<span style="color:#75715e">//ï¿½ï¿½ï¿½ï¿½(numerator)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	T d;<span style="color:#75715e">//ï¿½ï¿½Ä¸(denominator)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>};
</span></span></code></pre></div><blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>µ±ÎÒÃÇ±àĞ´Ò»¸ö class template£¬¶øËüËùÌá¹©Ö® &quot; Óë´Ë template Ïà¹ØµÄ &quot; º¯ÊıÖ§³Ö &quot; ËùÓĞ²ÎÊıÖ®ÒşÊ½ÀàĞÍ×ª»» &quot; Ê±£¬Çë½«ÄÇĞ©º¯Êı¶¨ÒåÎª &quot; class template ÄÚ²¿µÄ friend º¯Êı &ldquo;¡£</li>
</ul>
<h2 id="-47Ê¹-traits-classes-Ï£">Ìõ¿î 47£ºÇëÊ¹ÓÃ traits classes ±íÏÖÀàĞÍĞÅÏ¢</h2>
<ul>
<li>STL Ö÷ÒªÓÉ &quot; ÓÃÒÔ±íÏÖÈİÆ÷¡¢µü´úÆ÷ºÍËã·¨ &quot; µÄ templates ¹¹³É£¬ÒÔ¼°Èô¸É¹¤¾ßĞÔ templates¡£</li>
<li>STL ¹²ÓĞ 5 ÖÖµü´úÆ÷·ÖÀà</li>
</ul>
<p>Input µü´úÆ÷|Output µü´úÆ÷|Forward µü´úÆ÷|Bidirectionalµü´úÆ÷|Random access µü´úÆ÷
&mdash;-|
Istream_iterators|Ostream_iterators |²»Ö§³Ölinked list|STL list, set, multiset, map, multimap µÄµü´úÆ÷|vector,deque, string µÄµü´úÆ÷
|
Ö»ÄÜÏòÇ°×î¶àÒ»´Î¶Á²Ù×÷|Ö»ÄÜÏòÇ°×î¶àÒ»´ÎĞ´²Ù×÷|ÏòÇ°¶à´Î²Ù×÷|¿ÉÒÔÏòÇ°ÒÆ¶¯£¬»¹¿ÉÒÔÏòºóÒÆ¶¯|Ö§³Öµü´úÆ÷ËãÊõ£¬Ë«Ïò</p>
<blockquote>
<p>is-a¹ØÏµ£º</p>
<ul>
<li>input¡¢output</li>
<li>forward : public input</li>
<li>bidirectional : public forward</li>
<li>random : public bidirectional</li>
</ul>
</blockquote>
<ul>
<li>advance(Iter, Disance)</li>
<li>Éè¼Æ²¢ÊµÏÖÒ»¸ö traits class£º</li>
</ul>
<blockquote>
<ul>
<li>È·ÈÏÈô¸ÉÄãÏ£Íû½«À´¿ÉÈ¡µÃµÄÀàĞÍÏà¹ØĞÅÏ¢¡£ÀıÈç¶Ôµü´úÆ÷¶øÑÔ£¬ÎÒÃÇÏ£Íû½«À´¿ÉÈ¡µÃÆä·ÖÀà (category) ¡£</li>
<li>Îª¸ÃĞÅÏ¢Ñ¡ÔñÒ»¸öÃû³Æ ( ÀıÈç iterator_category) ¡£</li>
<li>Ìá¹©Ò»¸ö template ºÍÒ»×éÌØ»¯°æ±¾ ( ÀıÈçÉÔÔçËµµÄ iterator_traits) £¬ÄÚº¬ÄãÏ£ÍûÖ§³ÖµÄÀàĞÍÏà¹ØĞÅÏ¢¡£</li>
</ul>
</blockquote>
<ul>
<li>ÈçºÎÊ¹ÓÃÒ»¸ö traits class£º</li>
</ul>
<blockquote>
<ul>
<li>½¨Á¢Ò»×éÖØÔØº¯Êı (Éí·İÏñÀÍ¹¤) »òº¯ÊıÄ£°å (ÀıÈç doadvance) £¬±Ë´Ë¼äµÄ²îÒìÖ»ÔÚÓÚ¸÷×ÔµÄ traits ²ÎÊı¡£ÁîÃ¿¸öº¯ÊıÊµÏÖÂëÓëÆä½ÓÊÜÖ® traits ĞÅÏ¢ÏàÓ¦ºÍ¡£</li>
<li>½¨Á¢Ò»¸ö¿ØÖÆº¯Êı¡´Éí·İÏñ¹¤Í·) »òº¯ÊıÄ£°å (ÀıÈç advance) £¬Ëüµ÷ÓÃÉÏÊöÄÇĞ© &quot; ÀÍ¹¤º¯Êı &quot; ²¢´«µİ traits class ËùÌá¹©µÄĞÅÏ¢¡£</li>
</ul>
</blockquote>
<blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>Traits classes Ê¹µÃ &quot; ÀàĞÍÏà¹ØĞÅÏ¢ &quot; ÔÚ±àÒëÆÚ¿ÉÓÃ¡£ ËüÃÇÒÔ templates ºÍ &quot; templates ÌØ»¯ &quot; Íê³ÉÊµÏÖ¡£</li>
<li>ÕûºÏÖØÔØ¼¼Êõ (overloading ) ºó£¬traits classes ÓĞ¿ÉÄÜÔÚ±àÒëÆÚ¶ÔÀàĞÍÖ´ĞĞ if&hellip;else ²âÊÔ¡£</li>
</ul>
<h2 id="-48Ê¶-template-Ô«">Ìõ¿î 48£ºÈÏÊ¶ template Ôª±à³Ì</h2>
<ul>
<li>Template metaprogramming (TMP£¬Ä£°åÔª±à³Ì) ÊÇ±àĞ´ template-based C++ ³ÌĞò²¢Ö´ĞĞÓÚ±àÒëÆÚµÄ¹ı³Ì¡£</li>
<li>template metaprogram (Ä£°åÔª³ÌĞò) ÊÇÒÔ C++ Ğ´³É¡¢Ö´ĞĞÓÚ C++ ±àÒëÆ÷ÄÚµÄ³ÌĞò¡£</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">//ï¿½×²ï¿½(factorial)Ä£ï¿½ï¿½Ôªï¿½ï¿½ï¿½ï¿½,ï¿½İ¹ï¿½Ä£ï¿½ï¿½ï¿½ï¿½ï¿½Ö»ï¿½Êµï¿½ï¿½Ñ­ï¿½ï¿½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">template</span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">unsigned</span> n<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">Factorial</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">enum</span>{value <span style="color:#f92672">=</span> n<span style="color:#f92672">*</span>Factorial<span style="color:#f92672">&lt;</span>n<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#f92672">&gt;::</span>value};
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">template</span><span style="color:#f92672">&lt;&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">Factorial</span><span style="color:#f92672">&lt;</span><span style="color:#ae81ff">0</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">enum</span>{Value <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>};
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">//main.cpp
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>cout<span style="color:#f92672">&lt;&lt;</span>Factorial<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">5</span><span style="color:#f92672">&gt;::</span>value<span style="color:#f92672">&lt;&lt;</span>endl;<span style="color:#75715e">//ï¿½ï¿½ï¿½ï¿½5ï¿½Ä½×²ï¿½
</span></span></span></code></pre></div><blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>Template metaprogramming (TMP£¬Ä£°åÔª±à³Ì) ¿É½«¹¤×÷ÓÉÔËĞĞÆÚÒÆÍù±àÒëÆÚ£¬Òò¶øµÃÒÔÊµÏÖÔçÆÚ´íÎóÕì²âºÍ¸ü¸ßµÄÖ´ĞĞĞ§ÂÊ¡£</li>
<li>TMP ¿É±»ÓÃÀ´Éú³É &quot; »ùÓÚÕş²ßÑ¡Ôñ×éºÏ &quot; (based on combinations of policy choices) µÄ¿Í»§¶¨ÖÆ´úÂë£¬Ò²¿ÉÓÃÀ´±ÜÃâÉú³É¶ÔÄ³Ğ©ÌØÊâÀàĞÍ²¢²»ÊÊºÏµÄ´úÂë¡£</li>
</ul>
<blockquote>
<p>µÚ°ËÕÂ ¶¨ÖÆ new ºÍ delete</p>
</blockquote>
<h2 id="-49-new-handler-Ï">Ìõ¿î 49£ºÁË½â new-handler µÄĞĞÎª</h2>
<blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>set_new_handler ÔÊĞí¿Í»§Ö¸¶¨Ò»¸öº¯Êı£¬ÔÚÄÚ´æ·ÖÅäÎŞ·¨»ñµÃÂú×ãÊ±±»µ÷ÓÃ¡£</li>
<li>Nothrow newÊÇÒ»¸öÆÄÎª¾ÖÏŞµÄ¹¤¾ß£¬ÒòÎªËüÖ»ÊÊÓÃÓÚÄÚ´æ·ÖÅä; ºó¼ÌµÄ¹¹Ôìº¯Êıµ÷ÓÃ»¹ÊÇ¿ÉÄÜÅ×³öÒì³£¡£</li>
</ul>
<h2 id="-50-new--qelete-Äºæ»»Ê±">Ìõ¿î 50£ºÁË½â new ºÍ qelete µÄºÏÀíÌæ»»Ê±»ú</h2>
<ul>
<li>ºÎÊ±¿ÉÔÚ &quot; È«¾ÖĞÔµÄ &quot; »ò &quot; class ×¨ÊôµÄ &quot; »ù´¡ÉÏºÏÀíÌæ»»È±Ê¡µÄ new ºÍ delete:</li>
</ul>
<blockquote>
<ul>
<li>ÎªÁË¼ì²âÔËÓÃ´íÎó¡£</li>
<li>ÎªÁËÊÕ¼¯¶¯Ì¬·ÖÅäÄÚ´æÖ®Ê¹ÓÃÍ³¼ÆĞÅÏ¢¡£</li>
<li>ÎªÁËÔö¼Ó·ÖÅäºÍ¹é»¹µÄËÙ¶È¡£</li>
<li>ÎªÁË½µµÍÈ±Ê¡ÄÚ´æ¹ÜÀíÆ÷´øÀ´µÄ¿Õ¼ä¶îÍâ¿ªÏú¡£</li>
<li>ÎªÁËÃÖ²¹È±Ê¡·ÖÅäÆ÷ÖĞµÄ·Ç×î¼ÑÆëÎ» (suboptimal atignment) ¡£</li>
<li>ÎªÁË½«Ïà¹Ø¶ÔÏó³É´Ø¼¯ÖĞ¡£new ºÍ delete µÄ &quot; placement °æ±¾ &quot; (¼ûÌõ¿î52) ÓĞ¿ÉÄÜÍê³ÉÕâÑùµÄ¼¯´ØĞĞÎª¡£</li>
<li>ÎªÁË»ñµÃ·Ç´«Í³µÄĞĞÎª¡£</li>
</ul>
</blockquote>
<blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>ÓĞĞí¶àÀíÓÉĞèÒªĞ´¸ö×Ô¶¨µÄ new ºÍ delete£¬°üÀ¨¸ÄÉÆĞ§ÄÜ¡¢¶Ô heap ÔËÓÃ´íÎó½øĞĞµ÷ÊÔ¡¢ÊÕ¼¯ heap Ê¹ÓÃĞÅÏ¢¡£</li>
</ul>
<h2 id="-51Ğ´new--delete-Ê±Ø³">Ìõ¿î 51£º±àĞ´new ºÍ delete Ê±Ğè¹ÌÊØ³£¹æ</h2>
<blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>OPerator new Ó¦¸ÃÄÚº¬Ò»¸öÎŞÇîÑ­»·£¬²¢ÔÚÆäÖĞ³¢ÊÔ·ÖÅäÄÚ´æ£¬Èç¹ûËüÎŞ·¨Âú×ãÄÚ´æĞèÇó£¬¾Í¸Ãµ÷ÓÃ new-handler¡£ËüÒ²Ó¦¸ÃÓĞÄÜÁ¦´¦Àí 0 bytes ÉêÇë¡£Class ×¨Êô°æ±¾Ôò»¹Ó¦¸Ã´¦Àí &quot; ±ÈÕıÈ·´óĞ¡¸ü´óµÄ( ´íÎó ) ÉêÇë &quot; ¡£</li>
<li>operator delete Ó¦¸ÃÔÚÊÕµ½ null Ö¸ÕëÊ±²»×öÈÎºÎÊÂ¡£Class ×¨Êô°æ±¾Ôò»¹Ó¦¸Ã´¦Àí &quot; ±ÈÕıÈ·´óĞ¡¸ü´óµÄ ( ´íÎó ) ÉêÇë &quot; ¡£</li>
</ul>
<h2 id="52Ğ´-placement-new-Ò³Ò«Ğ´-placement-delete">Ìõ¿î52£ºĞ´ÁË placement new Ò²ÒªĞ´ placement delete</h2>
<ul>
<li>Èç¹û operator new½ÓÊÜµÄ²ÎÊı³ıÁËÒ»¶¨»áÓĞµÄÄÇ¸ö size_tÖ®Íâ»¹ÓĞÆäËû£¬Õâ±ãÊÇ¸öËùÎ½µÄ placerment new¡£</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">#include</span><span style="color:#75715e">&lt;new&gt;//ï¿½ï¿½×¼ï¿½ï¿½</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span><span style="color:#f92672">*</span> <span style="color:#66d9ef">operator</span> <span style="color:#a6e22e">new</span>(std: <span style="color:#f92672">:</span>size_t, <span style="color:#66d9ef">void</span><span style="color:#f92672">*</span> PMemory) <span style="color:#66d9ef">throw</span>(); <span style="color:#75715e">//ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½×¼ï¿½ï¿½ï¿½Úµï¿½pacement new
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//ï¿½Ç±ï¿½×¼
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span><span style="color:#f92672">*</span> <span style="color:#66d9ef">operator</span> <span style="color:#a6e22e">new</span>(std: <span style="color:#f92672">:</span>size_t, std<span style="color:#f92672">::</span>ostream <span style="color:#f92672">&amp;</span>) <span style="color:#66d9ef">throw</span>(std<span style="color:#f92672">::</span>bad_alloc);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#66d9ef">operator</span> <span style="color:#a6e22e">delete</span>(<span style="color:#66d9ef">void</span> <span style="color:#f92672">*</span>, std<span style="color:#f92672">::</span>ostream <span style="color:#f92672">&amp;</span>) <span style="color:#66d9ef">throw</span>();<span style="color:#75715e">//placement delete
</span></span></span></code></pre></div><ul>
<li>È±Ê¡Çé¿öÏÂ C++ ÔÚ global ×÷ÓÃÓòÄÚÌá¹©ÒÔÏÂĞÎÊ½µÄ operator new£º</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">#include</span><span style="color:#75715e">&lt;new&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span><span style="color:#f92672">*</span> <span style="color:#66d9ef">operator</span> <span style="color:#a6e22e">new</span>(std: <span style="color:#f92672">:</span>size_t)<span style="color:#66d9ef">throw</span>();<span style="color:#75715e">//ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½new
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span><span style="color:#f92672">*</span> <span style="color:#66d9ef">operator</span> <span style="color:#a6e22e">new</span>(std: <span style="color:#f92672">:</span>size_t, <span style="color:#66d9ef">void</span> <span style="color:#f92672">*</span>) <span style="color:#66d9ef">throw</span>();<span style="color:#75715e">//placement new
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span><span style="color:#f92672">*</span> <span style="color:#66d9ef">operator</span> <span style="color:#a6e22e">new</span>(std: <span style="color:#f92672">:</span>size_t, <span style="color:#66d9ef">const</span> std<span style="color:#f92672">::</span>nothrow_t <span style="color:#f92672">&amp;</span>) <span style="color:#66d9ef">throw</span>();<span style="color:#75715e">//nothrow new
</span></span></span></code></pre></div><ul>
<li>Èç¹ûÄãÔÚ class ÄÚÉùÃ÷ÈÎºÎ operator news£¬Ëü»áÕÚÑÚÉÏÊöÕâĞ©±ê×¼ĞÎÊ½¡£ÎªÊ¹ÕâĞ©º¯ÊıÓĞ×ÅÆ½³£µÄĞĞÎª£¬Ö»ÒªÁîÄãµÄ class ×¨Êô°æ±¾µ÷ÓÃ global °æ±¾¼´¿É£º</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">//ï¿½ï¿½ï¿½ï¿½×¼ï¿½ï¿½Ê½ï¿½ï¿½ï¿½ï¿½Ò»ï¿½ï¿½classï¿½Ğ£ï¿½È»ï¿½ï¿½ï¿½Ã¿Í»ï¿½ï¿½Ì³Ğ¼ï¿½usingï¿½ï¿½ï¿½ï¿½Ê½È¡ï¿½Ã±ï¿½×¼ï¿½ï¿½Ê½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">standard</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span><span style="color:#f92672">*</span> <span style="color:#66d9ef">operator</span> <span style="color:#66d9ef">new</span>(std<span style="color:#f92672">::</span>size_t size)<span style="color:#66d9ef">throw</span>(std<span style="color:#f92672">::</span>bad_alloc)
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> <span style="color:#f92672">::</span><span style="color:#66d9ef">operator</span> <span style="color:#66d9ef">new</span>(size);<span style="color:#75715e">//ï¿½Ö±ï¿½ï¿½ï¿½ï¿½Ã±ï¿½×¼ï¿½ï¿½Ê½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	}
</span></span><span style="display:flex;"><span>	...
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">wiget</span><span style="color:#f92672">:</span><span style="color:#66d9ef">public</span> standard
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">using</span> standard<span style="color:#f92672">::</span><span style="color:#66d9ef">operator</span> <span style="color:#66d9ef">new</span>;
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">//ï¿½ï¿½ï¿½ï¿½ï¿½Ô¼ï¿½ï¿½ï¿½operator new
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>µ±ÄãĞ´Ò»¸ö placement operator new£¬ÇëÈ·¶¨Ò²Ğ´³öÁË¶ÔÓ¦µÄ placerment operator delete¡£Èç¹ûÃ»ÓĞÕâÑù×ö£¬ÄãµÄ³ÌĞò¿ÉÄÜ»á·¢ÉúÒşÎ¢¶øÊ±¶ÏÊ±ĞøµÄÄÚ´æĞ¹Â©¡£</li>
<li>µ±ÄãÉùÃ÷ placement new ºÍ placement delete£¬ÇëÈ·¶¨²»ÒªÎŞÒâÊ¶ ( ·Ç¹ÊÒâ )  µØÕÚÑÚÁËËüÃÇµÄÕı³£°æ±¾¡£</li>
</ul>
<blockquote>
<p>µÚ¾ÅÕÂÔÓÏîÌÖÂÛ</p>
</blockquote>
<h2 id="-53Ò«Ä¾">Ìõ¿î 53£º²»ÒªÇáºö±àÒëÆ÷µÄ¾¯¸æ</h2>
<ul>
<li>¾¯¸æĞÅÏ¢ÌìÉúºÍ±àÒëÆ÷ÏàÒÀ£¬²»Í¬µÄ±àÒëÆ÷ÓĞ²»Í¬µÄ¾¯¸æ±ê×¼¡£</li>
</ul>
<blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>ÑÏËà¶Ô´ı±àÒëÆ÷·¢³öµÄ¾¯¸æĞÅÏ¢¡£Å¬Á¦ÔÚÄãµÄ±àÒëÆ÷µÄ×î¸ß ( ×îÑÏ¿Á ) ¾¯¸æ¼¶±ğÏÂÕùÈ¡ &quot; ÎŞÈÎºÎ¾¯¸æ &quot; µÄÈÙÓş ¡£</li>
<li>²»Òª¹ı¶ÈÒĞÀµ±àÒëÆ÷µÄ±¨¾¯ÄÜÁ¦£¬ÒòÎª²»Í¬µÄ±àÒëÆ÷¶Ô´ıÊÂÇéµÄÌ¬¶È²¢²»ÏàÍ¬¡£Ò»µ©ÒÆÖ²µ½ÁíÒ»¸ö±àÒëÆ÷ÉÏ£¬ÄãÔ­±¾ÒĞÀµµÄ¾¯¸æĞÅÏ¢ÓĞ¿ÉÄÜÏûÊ§¡£</li>
</ul>
<h2 id="-54Õ¬Ï¥-tr1-ÚµÄ±">Ìõ¿î 54£ºÈÃ×Ô¼ºÊìÏ¤°üÀ¨ TR1 ÔÚÄÚµÄ±ê×¼³ÌĞò¿â</h2>
<blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>C++ ±ê×¼³ÌĞò¿âµÄÖ÷Òª»úÄÜÓÉ STL¡¢iostreams¡¢locales ×é³É¡£²¢°üº¬ C99 ±ê×¼³ÌĞò¿â¡£</li>
<li>TR1 Ìí¼ÓÁËÖÇÄÜÖ¸Õë (ÀıÈç trl: :shared_ptr) ¡¢Ò»°ã»¯º¯ÊıÖ¸Õë (trl: :function) ¡¢hash-based ÈİÆ÷¡¢ÕıÔò±í´ïÊ½ (regular expressions) ÒÔ¼°ÁíÍâ 10¸ö×é¼şµÄÖ§³Ö¡£</li>
<li>TR1 ×ÔÉíÖ»ÊÇÒ»·İ¹æ·¶¡£Îª»ñµÃ TR1 Ìá¹©µÄºÃ´¦£¬ÄãĞèÒªÒ»·İÊµÎï¡£Ò»¸öºÃµÄÊµÎïÀ´Ô´ÊÇ Boost¡£</li>
</ul>
<h2 id="-55Õ¬Ï¥-boost">Ìõ¿î 55£ºÈÃ×Ô¼ºÊìÏ¤ Boost</h2>
<ul>
<li>Boost ÊÇÒ»¸ö C++ ¿ª·¢Õß¼¯½áµÄÉçÈº, Ò²ÊÇÒ»¸ö¿É×ÔÓÉÏÂÔØµÄ C++ ³ÌĞò¿âÈº¡£<a href="http://boost.org">boostÍøÖ·</a></li>
<li>Boost Graph Library (ÓÃÓÚ±àĞ´ÈÎÒâ graph ½á¹¹)¡£</li>
<li>Boost MPL Library (Ò»¸öÔª±à³Ì³ÌĞò¿â£¬metaprogramming library)¡£</li>
<li>Boost ³ÌĞò¿âÄÚ°üº¬ÖÖÀà£º</li>
</ul>
<blockquote>
<ul>
<li>×Ö·û´®ÓëÎÄ±¾´¦Àí¡£</li>
<li>ÈİÆ÷¡£</li>
<li>º¯Êı¶ÔÏóºÍ¸ß¼¶±à³Ì¡£</li>
<li>·ºĞÍ±à³Ì (Generic programming)¡£</li>
<li>Ä£°åÔª±à³Ì(Template metaprogramming£¬TMP)¡£</li>
<li>ÊıÑ§ºÍÊıÖµ (Math and numerics)¡£</li>
<li>ÕıÈ·ĞÔÓë²âÊÔ (Correctness and testing)¡£</li>
<li>Êı¾İ½á¹¹¡£</li>
<li>ÓïÑÔ¼äµÄÖ§³Ö (Inter-language support)¡£</li>
<li>ÄÚ´æ¡£</li>
<li>µÈµÈ</li>
</ul>
</blockquote>
<blockquote>
<p><em><strong>Ğ¡½á</strong></em></p>
</blockquote>
<ul>
<li>Boost ÊÇÒ»¸öÉçÈº£¬Ò²ÊÇÒ»¸öÍøÕ¾¡£ÖÂÁ¦ÓÚÃâ·Ñ¡¢Ô´Âë¿ª·Å¡¢Í¬ÁÅ¸´ÉóµÄ C++ ³ÌĞò¿â¿ª·¢¡£Boost ÔÚ C++ ±ê×¼»¯¹ı³ÌÖĞ°çÑİÉî¾ßÓ°ÏìÁ¦µÄ½ÇÉ«¡£</li>
<li>Boost Ìá¹©Ğí¶à TR1 ×é¼şÊµÏÖÆ·£¬ÒÔ¼°ÆäËûĞí¶à³ÌĞò¿â¡£</li>
<li></li>
</ul>

    </div>
    <div class="post-footer">
      
    </div>
  </article>

    </main>
  </body>
</html>
